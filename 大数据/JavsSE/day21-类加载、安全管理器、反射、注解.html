<html>
<head>
  <title>day21-类加载、安全管理器、反射、注解</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/603932 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 12pt;
    }
  </style>
</head>
<body>
<a name="6515"/>
<h1>day21-类加载、安全管理器、反射、注解</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2021/1/24 15:22</i></td></tr>
<tr><td><b>更新时间：</b></td><td><i>2021/8/6 10:33</i></td></tr>
</table>
</div>
<br/>

<div>
<span><div><div>static修饰下列内容:</div><div style="margin-left: 40px;">类：那么这个类必然是内部类</div><div style="margin-left: 40px;"><br/></div><div style="margin-left: 40px;">属性：静态变量，类变量</div><div style="margin-left: 40px;">     1.属于类;</div><div style="margin-left: 40px;">     2.类加载的时候就加载这些静态变量的值了;</div><div style="margin-left: 80px;">类加载就是把.class文件加在方法区里面, 并且在堆里面生成一个对应的对象, 这些对象都是Class类的对象, 我们可以通过这些对象, 调用Class类的相应方法, 来获得字节码文件中的相应的信息,如getName()方法。之所以所有的字节码文件在堆中生成的对应的对象都是Class类型的, 是因为所有字节码文件在堆中生成的对象都有共同的特征和行为, 所以就可以抽取出一个类(因为类就是相似特征的一个集合),这个类就是Class。我们通过字节码文件在堆中生成的对象调用Class类相应的方法, 就可以获得字节码文件的所有信息</div><div style="margin-left: 40px;">     3.类卸载。</div><div style="margin-left: 40px;"><br/></div><div style="margin-left: 40px;">方法：静态方法</div><div style="margin-left: 40px;">     1.只能直接访问静态成员</div><div style="margin-left: 40px;">     2.静态方法不能使用 this,super</div><div style="margin-left: 40px;"><br/></div><div style="margin-left: 40px;">代码块：静态块</div><div style="margin-left: 40px;">     static{</div><div style="margin-left: 40px;">       n = 22;</div><div style="margin-left: 40px;">       初始化类：</div><div style="margin-left: 40px;">     }</div><div><br/></div><div>静态变量的初始化过程：</div><div>    1.默认初始化(默认初始化是指:若静态变量定义后没有直接赋值, 则会在初始化阶段给它附一个默认值);</div><div>    2.声明处或 静态块处初始化。</div><div>------------------------------------------------------------------------------------------------------------------------------------</div><div>举例: </div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>上面的例子中, 两次输出的结果都会是6, 因为一个应用程序只能有一个main()方法, 而这里是两个main()方法, 说明这里是两个应用程序, 所以这里的两次运行结果是相同的。</div><div><br/></div><div>Java程序是怎么运行的?</div><div><span>    </span>javac命令进行编译</div><div><span>    </span>java命令调用虚拟机(JVM),也可以说是JVM进程</div><div><span>    </span>程序运行结束后, 整个JVM的内存空间会被释放掉, 下次再运行新的java程序会再调用新的JVM虚拟机。所以上面的例子中的类A的静态变量a的值是不会累加的。</div><div><br/></div><div>虚拟机在运行代码时首先启动一个主线程执行主方法里的内容。在代码使用到某个类之前, 应该就已经把该类加载到了虚拟机中</div><div><br/></div><div>java应用程序结束的方式：</div><div>1.正常结束；</div><div>2.异常 ，错误；</div><div>3.System.exit(0);</div><div>只要应用程序结束, 那么所有存在java虚拟机内存里的数据都会丢失, 因为所有存在jvm里的数据都是临时存储, 目前只学了一个永久存储那就是文件存储,当然永久存储还有数据库存储。</div><div>-------------------------------------</div><div>类的生命周期：</div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [1].png" type="image/png" data-filename="Image.png" width="701"/></div><div><span style="font-weight: bold;">加载、连接、初始化三个步骤合起来称为类加载过程。</span>所以要使用某个类的话, 必须先完成加载、连接、初始化这三个步骤, 才能正常使用。</div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">1.加载</span></div><div>  把字节码文件 加载到方法区中，</div><div>  并且生成对应的对象(Class类类型的对象) 在堆中。</div><div><br/></div><div><span style="font-weight: bold;">2.连接</span> (连接主要是把字节码文件中的数据加载到jre中)</div><div>  1）验证：</div><div>    验证字节码文件是否正确；(格式是否正确, 里面的属性和方法是否正确, 是不是正常途径生成的字节码文件) 这一步主要是为了保护虚拟机, 避免对虚拟机环境的恶意破坏</div><div>  2）准备：</div><div>    检查类中是否有静态变量, 如果有, 为类中的静态变量 开辟空间，进行默认初始化(注意: 只进行默认初始化化, 也就是只给默认值, 即使该静态变量赋了初值, 在这步也不会将这个初值给它)；</div><div>  3）解析：(把字节码文件中的符号语言(引用),通过解析转换成直接语言(引用))</div><div>    符号引用: 属性名称、方法名称、类的名称等等, 都是以符号的形式来表示的。在字节码以符号来表示的话, 具体调用这些属性、方法的时候, 并不知道他们具体在字节码文件中的什么位置, 所以, 要转换为直接引用, 标记好每个属性、方法的具体位置</div><div>    直接引用：直接引用就相当于指针, 所以解析就相当于把符号替换为指针</div><div><br/></div><div><span style="font-weight: bold;">3.初始化</span></div><div>  查看各静态变量有没有声明处初始化或静态块初始化, 如果有, 为静态变量 进行声明处 或者 静态块处初始化。</div><div><br/></div><div>类的初始化:</div><div>一个类什么时候会被初始化呢? </div><div style="margin-left: 40px;">当创建某个类的新实例时 (即创建对象时)</div><div style="margin-left: 40px;">当调用某个类的静态成员；<span style="color: rgb(255, 0, 0);">(被static final修饰的静态常量要特别注意, 可以在编译器确定其值的静</span></div><div style="margin-left: 40px;"><span style="color: rgb(255, 0, 0);">                                        态常量不会引起类的初始化, 见后面的例子)</span></div><div style="margin-left: 40px;">当初始化某个子类时,该子类的所有父类都会被初始化。</div><div style="margin-left: 40px;">当使用反射方法强制创建某个类或接口的对象时</div><div style="margin-left: 40px;">当虚拟机通过&quot;java&quot;命令运行启动类(也就是主方法所在的类)时</div><div><br/></div><div>上面所说的初始化都是在某个类第一次被使用时才会引发类的初始化, 若一个类第二次重复使用时, 说明它已经被加载过了, 是不会再重复加载的。</div><div><br/></div><div><br/></div><div>要验证 类有没有加载 最好的方法就是: 新建一个静态代码块或者在现成的静态代码块里加一个打印输出语句, 如果类加载了,那么这条打印输出语句必然会被打印到控制台, 因为类加载(初始化阶段时)必然会把静态块里面的东西执行一遍。如果该类没有被加载, 那么就不会打印了。</div><div><br/></div><div><span style="color: rgb(166, 0, 196);">需要特别注意的一种情况就是static final的变量, 这会被当成常量来看待, 如果在编译期就可以确定该常量的值,调用该常量就不会引起类加载。 如下图, 所有出现sn变量的地方都会用11来代替, 字节码文件是没有sn这个变量的, 所以, 调用sn是不会引起类加载的。也就是说 调用在编译期可以确定其值的常量不会引起类加载。(下下图是一个不能在编译期确定其值的常量的例子)</span></div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [2].png" type="image/png" data-filename="Image.png" width="704"/></div><div><br/></div><div><br/></div><div><span style="color: rgb(166, 0, 196);">但是要注意的是, 只有在编译期能确定其值的变量, 才不会引起类的加载, 但有些被static final修饰的变量并不能在编译期确定其值, 比如下面这种情况 ,sn的值在编译期变得不能确定了, (此时字节码文件中还是没有sn, 而是所有的sn都被11+n替代了??? 而被11+n替代是不能确定n的值了,所以在字节码文件中变量n的值不能确定才被认为是sn的值不能确定的?), 此时再调用sn, 就需要加载Demo类了。</span></div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [3].png" type="image/png" data-filename="Image.png" width="702"/></div><div><br/></div><div><br/></div><div>------------------------------------------------------------------------------------------------------------------------------------------------</div><div>类加载器：</div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [4].png" type="image/png" data-filename="Image.png" width="690"/></div><div><br/></div><div>分类：</div><div>根类加载器(启动类加载器)：<span style="font-size: 17pt;"><span style="font-size: 17pt; color: rgb(79, 79, 79); font-family: &quot;PingFang SC&quot;; font-weight: bold;">Bootstrap ClassLoader</span></span></div><div>       负责加载jdk/jre/lib下的类, 也就是加载java中的基础的、核心的类库。如String、System类等</div><div style="margin-left: 40px;"><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: common-ligatures;">最顶层的加载类，主要加载核心类库，即</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: common-ligatures;">%JAVA_HOME%</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: common-ligatures;">/jre/lib下的rt.jar、resources.jar、charsets.jar和class等。另外需要注意的是可以通过启动jvm时指定-Xbootclasspath和路径来改变Bootstrap ClassLoader的加载目录。Bootstrap ClassLoader是由C/C++编写的，它本身是虚拟机的一部分，所以它并不是一个JAVA类，也就是无法在java代码中获取它的引用，JVM启动时通过Bootstrap类加载器加载rt.jar等核心jar包中的class文件，int.class,String.class都是由它加载。JVM初始化sun.misc.Launcher并创建Extension ClassLoader和AppClassLoader实例。并将ExtClassLoader设置为AppClassLoader的父加载器。Bootstrap没有父加载器，但是它却可以作用一个ClassLoader的父加载器。比如ExtClassLoader。这也可以解释通过ExtClassLoader的getParent方法获取为Null的现象。</span>    </div><div>扩展类加载器：<span style="font-size: 22px; background-color: rgb(255, 255, 255); color: rgb(79, 79, 79); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: common-ligatures; font-weight: bold;">Extention ClassLoader</span></div><div>   负责加载jdk/jre/lib/ext下的类, 也就是加载扩展类库。</div><div>     <span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: common-ligatures;">加载目录%JAVA_HOME%/jre/lib/ext目录下的jar包和class文件。还可以加载-D java.ext.dirs选项指定的目录。</span></div><div>    所以我们也可以自己编写一个类打成jar包, 放在扩展类库里面, 这样的话通过扩展类加载器就可以加载。</div><div><br/></div><div>系统类加载器(也叫 应用类加载器)：<span style="font-size: 22px; color: rgb(79, 79, 79); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: common-ligatures; font-weight: bold;">Application ClassLoader</span> (或<span style="font-size: 16px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-ligatures: common-ligatures;">System ClassLoader</span>)</div><div>       <span style="font-size: 16px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-ligatures: common-ligatures;">加载当前应用的classpath的所有类</span></div><ul><ul><li><div>父类加载器为扩展类加载器</div></li><li><div>它负责加载环境变量 classpath (如Windows里的环境变量CLASSPATH,里面的内容是: <span style="font-weight: bold;">.</span>;%JAVA_HOME%\lib\dt.jar;%JAVA_HOME%\lib\tools.jar)或系统属性 java.class.path 指定路径下的类库。<span style="color: rgb(166, 0, 196);">CLASSPATH中的&quot;.&quot;表示的是当前项目的路径, 也就是说系统类加载器也负责加载我们在项目中自己写的所有的类。</span></div></li><li><div><span style="font-weight: bold;">应用程序中的类加载器默认是系统类加载器</span></div></li><li><div>它是用户自定义类加载器的默认父加载器</div></li><li><div>通过 ClassLoader 的 getSystemClassLoader() 方法可以获取到该类加载器</div></li></ul></ul><div style="margin-left: 80px;"><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: common-ligatures;">开发者可以直接使用系统类加载器，一般情况下该类加载是程序中默认的类加载器，通过</span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; background-color: rgb(249, 242, 244); border-radius: 2px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: common-ligatures; line-height: 22px;">ClassLoader.</span><span style="outline: 0px; font-size: 14px; background-color: rgb(249, 242, 244); border-radius: 2px; overflow-wrap: break-word; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-variant-ligatures: common-ligatures; line-height: 22px;">getSystemClassLoader()</span><span style="font-size: 16px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-ligatures: common-ligatures;">方法可以获取到该类加载器。</span></div><div style="margin-left: 80px;"><span style="font-size: 16px;"><br/></span></div><div>自定义类加载器：Custom ClassLoader</div><div>  自己指定的路径(而且<span style="color: rgb(255, 0, 0);">不</span><span style="color: rgb(255, 0, 0);">能是上面三种类加载器会加载的路径,否则该路径就会被前面三种类加载器加载掉</span>)</div><div>  需要继承ClassLoader类<span style="color: rgb(166, 0, 196);">(其实上面的扩展类加载器和系统类加载器也都继承于 ClassLoader 类, 只有启动类加载器</span> <span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(166, 0, 196); font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">并不继承自 java.lang.ClassLoader，没有父加载器, 因为这个类加载是用c/c++语言实现的, 嵌套在JVM中</span><span style="color: rgb(166, 0, 196);">)</span></div><div style="margin-left: 40px;"><span style="color: rgb(255, 0, 0);">注意: 类加载器加载的都是.class文件 , 而不是.java文件, 所以自定义类加载器加载不在项目路径里的类时, 记得先把它编译一下。</span></div><h2 style="box-sizing: border-box; outline: 0px; margin: 8px 0px 16px; padding: 0px; font-size: 24px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; outline: 0px; font-size: 24px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></h2><h2 style="box-sizing: border-box; outline: 0px; margin: 8px 0px 16px; padding: 0px; font-size: 24px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; outline: 0px; font-size: 24px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(79, 79, 79); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-caps: normal; font-variant-ligatures: common-ligatures; font-weight: bold; line-height: 32px;">类加载器加载的先后顺序</span></h2><div style="box-sizing: border-box; outline: 0px; margin: 8px 0px 0px 40px; padding: 0px; list-style: decimal; overflow-wrap: break-word;"><span style="box-sizing: border-box; outline: 0px; overflow-wrap: break-word;">Bootstrap CLassloder</span></div><div style="box-sizing: border-box; outline: 0px; margin: 8px 0px 0px 40px; padding: 0px; list-style: decimal; overflow-wrap: break-word;"><span style="box-sizing: border-box; outline: 0px; overflow-wrap: break-word;">Extention ClassLoader</span></div><div style="box-sizing: border-box; outline: 0px; margin: 8px 0px 0px 40px; padding: 0px; list-style: decimal; overflow-wrap: break-word;"><span style="box-sizing: border-box; outline: 0px; overflow-wrap: break-word;">AppClassLoader</span></div><div style="box-sizing: border-box; outline: 0px; margin: 8px 0px 0px 40px; padding: 0px; list-style: decimal; overflow-wrap: break-word;">Custom ClassLoader</div><div style="box-sizing: border-box; outline: 0px; margin: 8px 0px 0px 40px; padding: 0px; list-style: decimal; overflow-wrap: break-word;"><br/></div><div><br/></div><div>------------------------------------------------------------------------------------------------------------------------------------------------</div><div><br/></div><div><span style="font-weight: bold;">父类委托(也叫双亲委派)</span></div><p style="box-sizing: border-box; outline: 0px; margin: 0px 0px 16px; padding: 0px; font-size: 16px; color: rgb(77, 77, 77); line-height: 26px; overflow-wrap: break-word; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-ligatures: common-ligatures; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"></p><div>##<span style="box-sizing: border-box; outline: 0px; overflow-wrap: break-word; color: rgb(190, 25, 33);">双亲委派模式工作原理</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;">双亲委派模式要求除了顶层的启动类加载器外，其余的类加载器都应当有自己的父类加载器，<span style="color: rgb(255, 0, 0);">请注意双亲委派模式中的父子关系并非通常所说的类继承关系(也就是说这些类加载之间并没有继承关系)，而是采用组合关系来复用父类加载器的相关代码</span>，类加载器间的关系如下：</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><img src="day21-类加载、安全管理器、反射、注解_files/Image [5].png" type="image/png" data-filename="Image.png" width="687"/></div><div style="box-sizing: border-box; outline: 0px; margin: 0px 0px 16px; padding: 0px; font-size: 16px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; outline: 0px; font-size: 16px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: common-ligatures; line-height: 26px;">双亲委派模式是在Java 1.2后引入的，</span><span style="box-sizing: border-box; outline: 0px; font-size: 16px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 16px; color: rgb(166, 0, 196); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: common-ligatures; line-height: 26px;">其工作原理的是，如果一个类加载器收到了类加载请求，它并不会自己先去加载，而是把这个请求委托给父类的加载器去执行，如果父类加载器还存在其父类加载器，则进一步向上委托，依次递归，请求最终将到达顶层的启动类加载器，如果父类加载器可以完成类加载任务，就成功返回，倘若父类加载器无法完成此加载任务，子加载器才会尝试自己去加载，这就是双亲委派模式，</span></span><span style="box-sizing: border-box; outline: 0px; font-size: 16px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: common-ligatures; line-height: 26px;">即每个儿子都很懒，每次有活就丢给父亲去干，直到父亲说这件事我也干不了时，儿子自己想办法去完成，这不就是传说中的实力坑爹啊？那么采用这种模式有啥用呢?</span></div><p style="box-sizing: border-box; outline: 0px; margin: 0px 0px 16px; padding: 0px; font-size: 16px; color: rgb(77, 77, 77); line-height: 26px; overflow-wrap: break-word; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-ligatures: common-ligatures; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"></p><div>##<span style="box-sizing: border-box; outline: 0px; overflow-wrap: break-word; color: rgb(190, 25, 33);">双亲委派模式优势</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;">采用双亲委派模式的好处是Java类随着它的类加载器一起具备了一种带有优先级的层次关系，通过这种层级关可以避免类的重复加载，当父亲已经加载了该类时，就没有必要子ClassLoader再加载一次。其次是考虑到安全因素，java核心api中定义类型不会被随意替换，假设通过网络传递一个名为</span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; background-color: rgb(249, 242, 244); border-radius: 2px; overflow-wrap: break-word; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 22px;-en-paragraph:true;">java.lang.Integer</span><span style="-en-paragraph:true;">的类，通过双亲委托模式传递到启动类加载器，而启动类加载器在核心Java API发现这个名字的类，发现该类已被加载，并不会重新加载网络传递的过来的</span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; background-color: rgb(249, 242, 244); border-radius: 2px; overflow-wrap: break-word; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 22px;-en-paragraph:true;">java.lang.Integer</span><span style="-en-paragraph:true;">，而直接返回已加载过的Integer.class，这样便可以防止核心API库被随意篡改。可能你会想，如果我们在classpath路径下自定义一个名为</span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; background-color: rgb(249, 242, 244); border-radius: 2px; overflow-wrap: break-word; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 22px;-en-paragraph:true;">java.lang.SingleInterge</span><span style="-en-paragraph:true;">类(该类是胡编的)呢？该类并不存在</span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; background-color: rgb(249, 242, 244); border-radius: 2px; overflow-wrap: break-word; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 22px;-en-paragraph:true;">java.lang</span><span style="-en-paragraph:true;">中，经过双亲委托模式，传递到启动类加载器中，由于父类加载器路径下并没有该类，所以不会加载，将反向委托给子类加载器加载，最终会通过系统类加载器加载该类。但是这样做是不允许，因为</span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; background-color: rgb(249, 242, 244); border-radius: 2px; overflow-wrap: break-word; color: rgb(199, 37, 78); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 22px;-en-paragraph:true;">java.lang</span><span style="-en-paragraph:true;">是核心API包，需要访问权限，强制加载将会报出如下异常</span></div><div style="box-sizing: border-box; outline: 0px; margin: 0px 0px 24px; padding: 8px 16px 6px 56px; position: relative; font-size: 14px; border-top: none; border-right: none; border-bottom: 1px solid rgb(245, 246, 247); border-left: none; overflow-wrap: break-word; background-color: rgb(40, 44, 52); z-index: 9; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="box-sizing: border-box; outline: 0px; font-size: 14px; background: rgb(40, 44, 52); border-radius: 4px; padding: 0.5em; overflow-x: auto; white-space: pre; overflow-wrap: normal; min-width: 94%; text-size-adjust: none; word-break: break-all; position: unset;"><span style="box-sizing: border-box; outline: 0px; font-size: 14px; background: rgb(40, 44, 52); border-radius: 4px; overflow-x: auto; white-space: pre; overflow-wrap: normal; min-width: 94%; text-size-adjust: none; word-break: break-all; position: unset; color: rgb(171, 178, 191); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: common-ligatures; line-height: 22px;">java</span><span style="box-sizing: border-box; outline: 0px; background: rgb(40, 44, 52); border-radius: 4px; overflow-x: auto; white-space: pre; overflow-wrap: normal; min-width: 94%; text-size-adjust: none; word-break: break-all; position: unset; font-size: 14px; color: rgb(153, 153, 153); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: normal;">.</span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; background: rgb(40, 44, 52); border-radius: 4px; overflow-x: auto; white-space: pre; overflow-wrap: normal; min-width: 94%; text-size-adjust: none; word-break: break-all; position: unset; color: rgb(171, 178, 191); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: common-ligatures; line-height: 22px;">lang</span><span style="box-sizing: border-box; outline: 0px; background: rgb(40, 44, 52); border-radius: 4px; overflow-x: auto; white-space: pre; overflow-wrap: normal; min-width: 94%; text-size-adjust: none; word-break: break-all; position: unset; font-size: 14px; color: rgb(153, 153, 153); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: normal;">.</span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; background: rgb(40, 44, 52); border-radius: 4px; overflow-x: auto; white-space: pre; overflow-wrap: normal; min-width: 94%; text-size-adjust: none; word-break: break-all; position: unset; color: rgb(171, 178, 191); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: common-ligatures; line-height: 22px;">SecurityException</span><span style="box-sizing: border-box; outline: 0px; background: rgb(40, 44, 52); border-radius: 4px; overflow-x: auto; white-space: pre; overflow-wrap: normal; min-width: 94%; text-size-adjust: none; word-break: break-all; position: unset; font-size: 14px; color: rgb(102, 153, 0); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: normal;">:</span> <span style="box-sizing: border-box; outline: 0px; font-size: 14px; background: rgb(40, 44, 52); border-radius: 4px; overflow-x: auto; white-space: pre; overflow-wrap: normal; min-width: 94%; text-size-adjust: none; word-break: break-all; position: unset; color: rgb(171, 178, 191); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: common-ligatures; line-height: 22px;">Prohibited</span> <span style="box-sizing: border-box; outline: 0px; background: rgb(40, 44, 52); border-radius: 4px; overflow-x: auto; white-space: pre; overflow-wrap: normal; min-width: 94%; text-size-adjust: none; word-break: break-all; position: unset; font-size: 14px; color: rgb(198, 120, 221); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: normal;">package</span> <span style="box-sizing: border-box; outline: 0px; font-size: 14px; background: rgb(40, 44, 52); border-radius: 4px; overflow-x: auto; white-space: pre; overflow-wrap: normal; min-width: 94%; text-size-adjust: none; word-break: break-all; position: unset; color: rgb(171, 178, 191); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: common-ligatures; line-height: 22px;">name</span><span style="box-sizing: border-box; outline: 0px; background: rgb(40, 44, 52); border-radius: 4px; overflow-x: auto; white-space: pre; overflow-wrap: normal; min-width: 94%; text-size-adjust: none; word-break: break-all; position: unset; font-size: 14px; color: rgb(102, 153, 0); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: normal;">:</span> <span style="box-sizing: border-box; outline: 0px; font-size: 14px; background: rgb(40, 44, 52); border-radius: 4px; overflow-x: auto; white-space: pre; overflow-wrap: normal; min-width: 94%; text-size-adjust: none; word-break: break-all; position: unset; color: rgb(171, 178, 191); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: common-ligatures; line-height: 22px;">java</span><span style="box-sizing: border-box; outline: 0px; background: rgb(40, 44, 52); border-radius: 4px; overflow-x: auto; white-space: pre; overflow-wrap: normal; min-width: 94%; text-size-adjust: none; word-break: break-all; position: unset; font-size: 14px; color: rgb(153, 153, 153); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: normal;">.</span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; background: rgb(40, 44, 52); border-radius: 4px; overflow-x: auto; white-space: pre; overflow-wrap: normal; min-width: 94%; text-size-adjust: none; word-break: break-all; position: unset; color: rgb(171, 178, 191); font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: common-ligatures; line-height: 22px;">lang</span></div></div><div style="box-sizing: border-box; outline: 0px; margin: 0px; padding: 0px 8px; list-style: none; overflow-wrap: normal; border-right: 1px solid rgb(197, 197, 197); word-break: break-all;"><span style="box-sizing: border-box; outline: 0px; overflow-wrap: normal; border-right: 1px solid rgb(197, 197, 197); word-break: break-all; color: rgb(153, 153, 153);">1</span></div><div style="box-sizing: border-box; outline: 0px; margin: 0px 0px 16px; padding: 0px; font-size: 16px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; outline: 0px; font-size: 16px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: common-ligatures; line-height: 26px;">所以无论如何都无法加载成功的。下面我们从代码层面了解几个Java中定义的类加载器及其双亲委派模式的实现，它们类图关系如下</span></div><div style="box-sizing: border-box; outline: 0px; margin: 0px 0px 16px; padding: 0px; font-size: 16px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 12pt; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: common-ligatures; line-height: 26px;"><img src="day21-类加载、安全管理器、反射、注解_files/Image [6].png" type="image/png" data-filename="Image.png"/></span></div><div style="box-sizing: border-box; outline: 0px; margin: 0px 0px 16px; padding: 0px; font-size: 16px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; outline: 0px; font-size: 16px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: common-ligatures; line-height: 26px;">从图可以看出顶层的类加载器是ClassLoader类，它是一个抽象类，其后所有的类加载器都继承自ClassLoader（不包括启动类加载器）</span></div><div><br/></div><div><br/></div><div><br/></div><div>类加载的过程: (父类委托的原理)</div><div style="margin-left: 40px;">1.先查看 此类是否加载过，加载过返回Class对象；</div><div style="margin-left: 40px;">2.没有加载过：</div><div style="margin-left: 40px;">  1）父加载器存在，层层委托，由父加载器加载，</div><div style="margin-left: 40px;">     能加载就 加载，不能加载 由自己申请的加载器加载；</div><div style="margin-left: 40px;">  2）父加载器不存在，直接有根类加载器加载，</div><div style="margin-left: 40px;">     能加载就 加载，不能加载 由自己申请的加载器加载；</div><div style="margin-left: 40px;"><br/></div><div style="margin-left: 40px;"><div><br/></div><div><br/></div></div><div>对于系统类加载器来说, 在java程序运行的过程中, 始终都会引用着已被加载的类的对象模板, 不会将对象模板卸载,直到应用程序结束之后才卸载。所以与之相关的, 我们都知道静态变量是属于类的, 所以在类没被卸载之前, 静态变量也是一直都存在的, 所占的空间不会被释放。也就是说静态变量的生命周期也是非常长的。</div><div>-------------------------------------------------------------------------------------------------------------------</div><div>举例: 如何查看一个类是哪个加载器加载的以及如何查看其父类加载器:</div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>打印结果如下:  </div><div>sun.misc.Launcher$AppClassLoader@659e0bfd中, <span style="font-size: unset; color: unset; font-family: unset;">sun.misc.Launcher是说明该加载器位于哪个包下, AppClassLoader就是加载器的类型, @符号后面的</span>&quot;659e0bfd&quot;<span style="font-size: unset; color: unset; font-family: unset;">就是地址。ExtClassLoader的父类加载器是null的原因也说过了, 因为根类加载器是用c++实现的, 是与其他加载器的实现方式不同的。</span></div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><br/></div><div>ClassLoader.loaderClass()方法详解:</div><div>ClassLoader.findClass()方法就是真正将字节码文件从文件中取到方法区,并在堆中生成对象模板的方法,详情请看下一个自定义类加载器的例子。</div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [9].png" type="image/png" data-filename="Image.png" width="865"/></div><div>------------------------------------------------------------------------------------------------------------------------------------------------</div><div>自定义一个类加载器举例:</div><div>假设 d:/data/目录下有一个Hello.class字节码文件。</div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div>------------------------------------------------------------------------------------------------------------------------------------------------</div><div>安全管理器(<span style="font-size: unset; color: unset; font-family: unset;">SecurityManager</span>)：保证  运行时  访问资源的权限的  安全性。</div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [11].png" type="image/png" data-filename="Image.png" width="615"/></div><div>  </div><div><br/></div><div>FileInputStream的构造器里面有一个getSecurityManager()方法来获得一个安全管理器SecurityManager<span style="font-size: unset; color: unset; font-family: unset;">。通过</span>SecurityManager来去管理我们需要访问的资源的权限</div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div>然后通过SecurityManager的checkRead()方法来查看具体有没有读的权限。</div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [13].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>接下来尝试自己定义一个安全管理器类用来读文件</div><div>因为FileInputStream的构造方法只用到了SecurityManager类的checkRead()方法, 所以可以忽略其他方法, 只重写这个方法。</div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [14].png" type="image/png" data-filename="Image.png" width="746"/></div><div>打印结果如下:</div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [15].png" type="image/png" data-filename="Image.png"/></div><div>-----------------------------------------------------------------------------------------------------------------------------</div><div>反射： (第一部分)</div><div>    Hadoop底层用的就是反射, 是架构师的必备技能。</div><div>  </div><div>    我们通常在jdbc中使用反射,如 Class.forName(&quot;com.mysql.jdbc.Driver&quot;)。因为数据库有可能用的是mysql、oracle/hive/hbase中的任何一个, 所以不能用new com.mysql.jdbc.Driver();直接写死用的是mysql数据库, 要根据具体情况来用反射来连接相应的数据库。所以接下来要连接其他数据库,如hive或oracle, 则只需将语句改为如下形式则可轻松连接:</div><div style="margin-left: 40px;">    Class.forName(&quot;com.oracle.jdbc.Driver&quot;)</div><div style="margin-left: 40px;">    Class.forName(&quot;com.hive2.jdbc.Driver&quot;)</div><div>    反射的好处：</div><div>        不用关心代码底层的细节   </div><div>        提升代码的灵活性</div><div><br/></div><div>    类的概念：</div><div>        具有相同属性（静态，属性）或行为（动态、方法）的一类事物的统称</div><div>        描述一类具有相同特征或属性的事物</div><div>    对象：</div><div>        类的实例化  类中的一个具体表现</div><div><br/></div><div>    有没有描述类的共同属性或行为的类呢？ 有, Class类就是。</div><div><span style="font-weight: bold;">    Class: 描述类的类。 </span>  </div><div>    一个<span style="font-size: unset; color: unset; font-family: unset;">类里面说白了就只有：属性、方法、构造方法。所以Class类</span><span style="font-size: unset; color: unset; font-family: unset;">说白了就是描述一个类里面的属性、方法、构造方法的。</span></div><div>   <span style="font-weight: bold;"> Class是反射的基石。</span></div><div><br/></div><div>    1）如何获取Class对象：</div><div>        类名.class  </div><div>            Class cla01=String.class;</div><div>        对象.getClass</div><div>            Class class02 = str.getClass();</div><div>        Class.forName</div><div>            Class class03 = Class.forName(&quot;java.lang.String&quot;);</div><div>        以上三种方式返回的是相同的对象</div><div><br/></div><div>        反射中有9种预定义的类型: 分别是 8种基本数据类型+void。因为这些都没有对应的对象模板(或者说他们根本不是个类),所以在反射中要将这些类的对象模板预定义好, 他们才能使用.class关键字, 如int.class。</div><div>        使用示例如下:</div><div>        <img src="day21-类加载、安全管理器、反射、注解_files/Image [16].png" type="image/png" data-filename="Image.png" width="762"/></div><div>    2)属性  方法   构造方法的</div><div>        Field:描述属性的  获取   赋值</div><div>        Method：描述方法的    获取   调用</div><div>        Constructor：描述构造方法的   获取  创建对象</div><div>--------------------------------------------------------------------------------------------------------------------------</div><div>反射：(第二部分)</div><div>  程序运行的时候，通过 字节码文件 <span style="color: rgb(166, 0, 196);">对应的对象</span>从<span style="font-size: unset; color: unset; font-family: unset;">字节码文件(即.class文件)中获得 此类的所有信息。</span></div><div><br/></div><div><span style="color: rgb(255, 0, 0); font-weight: bold;">java代码中的&quot;类.class&quot;中的&quot;.class&quot;关键字就是用来获得类对应的对象模板的,或者说用来获得类对应的Class类的对象的。</span><span style="font-weight: bold;"> </span><span style="color: rgb(255, 0, 0); font-weight: bold;">&quot;类.class&quot;的形式也很像文件系统中的字节码文件的格式, 而对象模板也正是由字节码文件生成的。</span></div><div>要注意, 不止有&quot;类.class&quot;, 还有&quot;基本数据类型.class&quot;(如&quot;int.class&quot;,而且int.class不等于Integer.class, 也就是说基本数据类型的对象模板和包装类的对象模板不一样), 还有&quot;void.class&quot;  。其实基本数据类型和void是没有对应的对象模板的, 但是Class类为他们专门预定义了对象模板。</div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Lantinghei SC&quot;, &quot;Microsoft YaHei&quot;, arial, 宋体, sans-serif, tahoma; font-variant-caps: normal; font-variant-ligatures: normal;">实际上java的每个类被编译成.</span><a href="https://www.baidu.com/s?wd=class%E6%96%87%E4%BB%B6&amp;tn=44039180_cpr&amp;fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1dBuWRvn1F9Pynsuj7WnHu90ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EPjDkrjR3P101" style="box-sizing: border-box; outline: none; cursor: pointer; overflow-wrap: break-word; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(63, 136, 191); font-family: &quot;PingFang SC&quot;, &quot;Lantinghei SC&quot;, &quot;Microsoft YaHei&quot;, arial, 宋体, sans-serif, tahoma; font-variant-caps: normal; font-variant-ligatures: normal;">class文件</a><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Lantinghei SC&quot;, &quot;Microsoft YaHei&quot;, arial, 宋体, sans-serif, tahoma; font-variant-caps: normal; font-variant-ligatures: normal;">的时候，java虚拟机（叫jvm）会自动为这个类生成一个类对象，这个对象保存了这个类的所有信息（成员变量，方法，构造器等），以后这个类要想实例化（也就是创建类的实例或创建类的对象）那么都要以这个class对象为蓝图（或模版）来创建这个类的实例。例如 class&lt;?&gt; c=Class.forName(&quot;com.pojo.User&quot;); c就是User的类对象，而 User u=new User();这个 u 就是以 c 为模版创建的，其实就相当于</span><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 14px; color: rgb(166, 0, 196); font-family: &quot;PingFang SC&quot;, &quot;Lantinghei SC&quot;, &quot;Microsoft YaHei&quot;, arial, 宋体, sans-serif, tahoma; font-variant-caps: normal; font-variant-ligatures: normal;">u=c.newInstance();</span></span> <span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Lantinghei SC&quot;, &quot;Microsoft YaHei&quot;, arial, 宋体, sans-serif, tahoma; font-variant-caps: normal; font-variant-ligatures: normal;">这个在java的反射里面讲的比较清楚。</span></div><div><br/></div><div>反射相关的类都位于java.lang.reflect包下。</div><div>通过反射访问以下内容: </div><div>访问属性：<span style="min-height: 14pt; font-size: 14pt; background: rgb(232, 242, 254); color: rgb(63, 127, 95); font-family: &quot;Courier New&quot;;">Field类就是属性类,Field类的一个对象就是一个属性</span></div><div>  getFields()获得公共的所有属性。</div><div style="margin-left: 40px;"><span style="color: rgb(166, 0, 196);">返回一个Field类型数组，其中包含当前类的public字段，如果此类继承于某个父类，同时包括父类的public字段。其它的proteced或private或default字段，无论是属于当前类还是父类都不被此方法获取。</span></div><div>  getDeclaredFields() 获得所有权限的属性，包括private</div><div style="margin-left: 40px;"><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 16px; color: rgb(166, 0, 196); font-family: -apple-system, BlinkMacSystemFont, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Segoe UI&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">返回一个Field类型数组，结果包含当前类的所有字段，private、protected、public或者无修饰符都在内。另外，此方法返回的结果不包括父类的任何字段(包括public的也获取不到)。 此方法只是针对当前类的。</span></span></div><div>  getName() 获得属性名称</div><div>  getType() 获得属性的类型</div><div>  Modifier.toString(field.getModifiers())获得访问的访问权限,如public </div><div>  getDeclaredField(&quot;属性名&quot;) 获得单个属性</div><div>  c.newInstance() 创建一个具体的类的实例（对象）</div><div>  set(obj, &quot;张三&quot;) 给属性赋值</div><div>  get(obj)  获得属性值</div><div>  setAccessible(true) 设置私有属性的访问权限为可访问。</div><div><br/></div><div>访问方法：</div><div>  getMethods()获得公共的所有方法。</div><div>  getDeclaredMethods() 获得所有的方法 <span style="color: rgb(166, 0, 196);">(getDeclaredMethods()和 getMethods()的区别与getFields()和 getDeclaredFields()的区别一样。或者说</span><span style="color: rgb(255, 0, 0); font-weight: bold;">Class类中的方法, 所有getDeclaredXXX()和getXXX()方法的区别都和上面的</span><span style="color: rgb(255, 0, 0); font-weight: bold;">getFields()和 getDeclaredFields()的一样</span><span style="color: rgb(166, 0, 196);">)</span></div><div>  getReturnType() 返回值类型</div><div>  getParameterTypes() 参数列表类型</div><div>  getDeclaredMethod(&quot;show&quot;, String.class,int.class)</div><div>  获得单个的方法 （方法名，参数列表类型）</div><div>  invoke(obj, &quot;hello&quot;,123) 调用方法</div><div>         (对象， 参数列表)</div><div><br/></div><div>访问构造器：</div><div>  getConstructors() 获得public的构造器 </div><div>  getDeclaredConstructors() 获得所有的构造器</div><div>  getDeclaredConstructor(int.class,String.class)</div><div>   获得单个的构造器 （参数列表类型）</div><div>  newInstance(11,&quot;李四&quot;) 调用构造器</div><div>             (参数列表)  </div><div><br/></div><div>访问注解：</div><div>  getDeclaredAnnotations()获得所有注解信息</div><div>  getAnnotations() 用于子类继承父类的注解</div><div><br/></div><div><span style="font-weight: bold;">反射的使用举例: 例子很长,但里面都是使用时的干货</span></div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [17].png" type="image/png" data-filename="Image.png"/></div><div>          <img src="day21-类加载、安全管理器、反射、注解_files/Image [18].png" type="image/png" data-filename="Image.png" width="610"/></div><div><span style="color: rgb(255, 0, 0);">通过反射创建新的类示例，有两种方式：</span></div><div style="margin-left: 40px;"><span style="color: rgb(255, 0, 0);">Class的newInstance()方法</span></div><div style="margin-left: 40px;"><span style="color: rgb(255, 0, 0);">Constructor的newInstance()方法</span></div><div><span style="color: rgb(255, 0, 0);">以下对两种调用方式给以比较说明：</span></div><div style="margin-left: 40px;"><span style="color: rgb(255, 0, 0);">Class的newInstance()方法</span><span style="color: rgb(255, 0, 0);">只能够调用 无参的构造函数;</span></div><div style="margin-left: 40px;"><span style="color: rgb(255, 0, 0);">Constructor的newInstance()方法</span><span style="color: rgb(255, 0, 0);">可以根据传入的参数，调用任意一个构造构造函数。</span></div><div style="margin-left: 40px;"><br/></div><div style="margin-left: 40px;"><span style="color: rgb(255, 0, 0);">Class的newInstance()方法 </span><span style="color: rgb(255, 0, 0);">要求被调用的构造函数是可见的，也即必须是 public类型的;</span></div><div style="margin-left: 40px;"><span style="color: rgb(255, 0, 0);">Constructor的newInstance()方法 </span><span style="color: rgb(255, 0, 0);">在特定的情况下</span><span style="color: rgb(255, 0, 0);">可以 调用私有的构造函数</span><span style="color: rgb(255, 0, 0);">(即在使用</span><span style="color: rgb(255, 0, 0);">Constructor的某对象c调用</span><span style="color: rgb(255, 0, 0);">newInstance()方法之前, 先</span><span style="color: rgb(255, 0, 0);">设置权限</span>c.setAccessible(<span style="font-weight: bold;">true</span>);<span style="color: rgb(255, 0, 0);">即可调用到私有的构造函数,而</span><span style="color: rgb(255, 0, 0);">Class的newInstance()方法不能调用到不可见的构造函数是因为Class类根本没有内置更改访问权限的方法</span>setAccessible(<span style="font-weight: bold;">true</span>)<span style="color: rgb(255, 0, 0);">)</span><span style="color: rgb(255, 0, 0);">。</span></div><div style="margin-left: 40px;"></div><div style="margin-left: 40px;"><span style="color: rgb(255, 0, 0);">Class的newInstance()方法 </span><span style="color: rgb(255, 0, 0);">抛出所有由被调用构造函数抛出的异常。</span></div><div style="margin-left: 40px;"><br/></div><div><br/></div><div>------------------------------------------------------------------------------------------------------------------------------</div><div>注解：</div><div><br/></div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [19].png" type="image/png" data-filename="Image.png"/></div><div>注解说白了就是帮助你在编译期进行检查, 给编译器提供信息, 看看你的操作是不是在注解范围内允许的操作,起到了进一步约束写代码的格式的作用。注解同时也是在源码中加一些扩充性的信息, 方便代码的阅读。而且有的注解还有它自己独特的功能。</div><div>并且, 反射技术可以获得各个注解的信息。</div><div><br/></div><div>系统注解有以下：</div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [20].png" type="image/png" data-filename="Image.png" width="373"/></div><div><br/></div><div>@Override   重写</div><div>@FunctionalInterface  函数式接口</div><div>@Deprecated  标记某个类或方法或属性已过时, 该类或方法或属性在使用时就会在中间划上一条横线, 表示它已被弃用(但其实仍然可以用,只是不推荐用了)</div><div>    <img src="day21-类加载、安全管理器、反射、注解_files/Image [21].png" type="image/png" data-filename="Image.png" width="564"/></div><div><br/></div><div>@SuppressWarnings(&quot;要镇压的警告类型&quot;)  在出现某种警告的时候, 镇压警告。有下面几种常见的警告类型:</div><div style="margin-left: 40px;">all    所有警告</div><div style="margin-left: 40px;">rawtypes   泛型使用的是原生类型的警告</div><div style="margin-left: 40px;">unchecked  未进行类型检查的警告</div><div style="margin-left: 40px;">unused  变量未使用的警告</div><div style="margin-left: 40px;">serial    序列化时未添加序列号的警告</div><div style="margin-left: 40px;"><br/></div><div>    使用举例: </div><div>        因为List是个泛型类型, 如果不指定泛型的具体类型参数, 那么List下面会有一条黄色的波浪线, 也就是警告。这个时候就可以使用编译器的提示来镇压原生类型(rawtypes)的警告了</div><div>        <img src="day21-类加载、安全管理器、反射、注解_files/Image [22].png" type="image/png" data-filename="Image.png" width="752"/></div><div>        镇压rawtypes警告后的效果如下:</div><div>        <img src="day21-类加载、安全管理器、反射、注解_files/Image [23].png" type="image/png" data-filename="Image.png" width="474"/></div><div>        于此同时还可以镇压另一个list变量还未使用的警告(unused): </div><div>        <img src="day21-类加载、安全管理器、反射、注解_files/Image [24].png" type="image/png" data-filename="Image.png" width="494"/></div><div>        镇压unused警告后的效果如下:</div><div>        <img src="day21-类加载、安全管理器、反射、注解_files/Image [25].png" type="image/png" data-filename="Image.png"/></div><div>        如果在原生类型下往泛型类的对象里面添加数据的话, 就会出现未检查(unchecked)的警告, 因为原生类型就默认类型参数是Object类型的, 这样的话什么数据都能传, 编译器就不知道传过来的数据合不合规,就会产生这个警告:</div><div>        <img src="day21-类加载、安全管理器、反射、注解_files/Image [26].png" type="image/png" data-filename="Image.png" width="678"/></div><div>        镇压unchecked警告后的效果如下:</div><div>        <img src="day21-类加载、安全管理器、反射、注解_files/Image [27].png" type="image/png" data-filename="Image.png" width="631"/></div><div>        当一个类继承Serializable接口时, 就会出现一个serial警告, 是要你添加一个序列化的ID,用于序列化与反序列化的版本匹配:</div><div>        <img src="day21-类加载、安全管理器、反射、注解_files/Image [28].png" type="image/png" data-filename="Image.png" width="762"/></div><div>        镇压serial警告后的效果如下:</div><div>        <img src="day21-类加载、安全管理器、反射、注解_files/Image [29].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>----------------------------------------------------------------------------------------------------------------------------------------------------</div><div>自定义注解:</div><div><br/></div><div>自定义注解的格式如下:</div><div style="margin-left: 40px;">@interface 注解名{</div><div style="margin-left: 40px;">    类型  成员名() [default 默认值]；     <span style="font-size: 12pt;">(&quot;default 默认值&quot;可给可不给,默认值可以是任何已定义类型的对象)</span></div><div style="margin-left: 40px;">    ……</div><div style="margin-left: 40px;">}</div><div><br/></div><div>自定义注解后还不能直接使用, 自定义完注解后还要加上元注解, 来说明自定义注解要使用在什么地方。</div><div>元注解：<span style="font-size: unset; color: unset; font-family: unset;">用来标注 自定义的注解的。</span>放在在自定义注解的前一行处(相当于自定义注解的注解, 所以叫元注解)<span style="font-size: unset; color: unset; font-family: unset;">。</span></div><div>元注解有四个: 功能各不相同。前面两个是最重要的, 一定要指定的。</div><div style="margin-left: 40px;"><span style="color: rgb(166, 0, 196);">@Target(ElementType.XXX)   指定自定义注解使用的范围</span></div><div style="margin-left: 40px;"><span style="color: rgb(166, 0, 196);">@Retention（ ）     指定生命周期</span></div><div style="margin-left: 40px;">@Inherited      指定被修饰的自定义注解将具有继承性。也就是说, 某自定义注解指定了@Inherited, 父类被该自定义注解修饰, 那么继承该父类的子类可也具有了的该自定义注解。</div><div style="margin-left: 40px;">@Documented  指定被修饰的自定义注解将在帮助文档中显示相应的信息</div><div><br/></div><div><span style="font-weight: bold;">@Target((ElementType.XXX) </span></div><div>ElementType是一个枚举类, 里面包含的常用枚举对象以及含义如下图, 选择了哪个枚举对象, 就只能在对应的范围内使用自定义注解:</div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [30].png" type="image/png" data-filename="Image.png" width="575"/></div><div><br/></div><div><span style="font-weight: bold;">@Retention(RetentionPolicy.XXX)</span></div><div>其中的RetentionPolicy也是枚举, 常用枚举对象如下图。</div><p style="box-sizing: border-box; outline: 0px; margin: 0px 0px 16px; padding: 0px; font-size: 16px; color: rgb(77, 77, 77); overflow: auto hidden; line-height: 26px !important; overflow-wrap: break-word; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"></p><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">1、</span><span style="box-sizing: border-box; outline: 0px; overflow-wrap: break-word; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(255, 102, 0); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">RetentionPolicy.SOURCE</span><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">：注解只保留在源文件，当Java文件编译成class文件的时候，注解被遗弃；</span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">2、</span><span style="box-sizing: border-box; outline: 0px; overflow-wrap: break-word; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(255, 102, 0); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">RetentionPolicy.CLASS</span><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">：注解被保留到class文件，但jvm加载class文件时候被遗弃，这是默认的生命周期；</span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">3、</span><span style="box-sizing: border-box; outline: 0px; overflow-wrap: break-word; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 102, 0); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">RetentionPolicy.RUNTIME</span><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">：注解不仅被保存到class文件中，jvm加载class文件之后，仍然存在；也就是在运行时该注解还存在。如果希望通过反射的技术来获得该自定义的注解信息, 那么一定要选择</span><span style="box-sizing: border-box; outline: 0px; overflow-wrap: break-word; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 102, 0); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">RetentionPolicy.RUNTIME</span><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal;">。</span></div><div style="box-sizing: border-box; outline: 0px; margin: 0px 0px 16px; padding: 0px; font-size: 16px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; outline: 0px; font-size: 14px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 26px;">这3个生命周期分别对应于：Java源文件(.java文件) ---&gt; .class文件 </span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 26px;">---&gt; </span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 26px;">内存中的字节码。</span></div><div style="box-sizing: border-box; outline: 0px; margin: 0px 0px 16px; padding: 0px; font-size: 16px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; outline: 0px; font-size: 14px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 26px;">那怎么来选择</span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 26px;">合适的</span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 26px;">注解生命周期呢？</span></div><div style="box-sizing: border-box; outline: 0px; margin: 0px 0px 16px; padding: 0px; font-size: 16px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; outline: 0px; font-size: 14px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 26px;">首先要明确生命周期长度 </span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold; line-height: 26px;">SOURCE &lt; CLASS &lt; RUNTIME</span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 26px;"> </span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 26px;">，所以前者能作用的地方后者一定也能作用。一般如果需要在运行时去动态获取注解信息，那只能用 RUNTIME 注解；如果要在编译时进行一些预处理操作，比如生成一些辅助代码（如 </span><a href="https://github.com/JakeWharton/butterknife" style="box-sizing: border-box; outline: none; font-size: 14px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); cursor: pointer; color: rgb(103, 149, 181); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 26px;">ButterKnife</a><span style="box-sizing: border-box; outline: 0px; font-size: 14px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1.25;">），就用 CLASS注解；如果只是做一些检查性的操作，比如</span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold; line-height: 1.25;"> @Override</span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1.25;"> </span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1.25;">和 </span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold; line-height: 1.25;">@SuppressWarnings</span><span style="box-sizing: border-box; outline: 0px; font-size: 14px; overflow-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1.25;">，则可选用 SOURCE 注解。</span></div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [31].png" type="image/png" data-filename="Image.png" width="647"/></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">@Inherited </span>      </div><div>子类可以继承父类的类类型上的注解。指定被修饰的自定义注解将具有继承性。也就是说, 如果某个类使用了该自定义注解, 那么其子类也会自动被该自定义注解修饰。</div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">@Documented</span> </div><div>如果某个自定义注解使用了该元注解, 那么生成的帮助文档中, 可以看到该自定义注解的相应的一些信息</div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [32].png" type="image/png" data-filename="Image.png"/></div><div>----------------------------------------------------------------------------------------------------------------------------</div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [33].png" type="image/png" data-filename="Image.png" width="698"/></div><div>----------------------------------------------------------------------------------------------------------------------------</div><div>自定义注解和注解解析使用举例:</div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [34].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>-----------------------------------------------------------------------------------------------------------------------</div><div>一个练习题,关于反射和注解:</div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [35].png" type="image/png" data-filename="Image.png"/></div><div>代码如下:</div><div><img src="day21-类加载、安全管理器、反射、注解_files/Image [36].png" type="image/png" data-filename="Image.png" width="826"/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div>  </div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><a href="day21-类加载、安全管理器、反射、注解_files/day19 - LIU_反射.pdf"><img src="day21-类加载、安全管理器、反射、注解_files/96d217000c383da23f27a0fbf20d5c45.png" alt="day19 - LIU_反射.pdf"></a></div><div><br/></div></div><div><br/></div></span>
</div></body></html> 