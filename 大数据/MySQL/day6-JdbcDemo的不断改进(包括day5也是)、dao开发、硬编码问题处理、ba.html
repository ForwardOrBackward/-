<html>
<head>
  <title>day6-JdbcDemo的不断改进(包括day5也是)、dao开发、硬编码问题处理、basedao开发</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/603932 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 12pt;
    }
  </style>
</head>
<body>
<a name="5064"/>
<h1>day6-JdbcDemo的不断改进(包括day5也是)、dao开发、硬编码问题处理、basedao开发</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2020/4/28 14:32</i></td></tr>
<tr><td><b>更新时间：</b></td><td><i>2020/4/29 11:47</i></td></tr>
</table>
</div>
<br/>

<div>
<span><div><span style="font-weight: bold;">1.jdbc概念</span></div><div>  对数据库统一访问,主要由接口组成。</div><div>  驱动:jdbc接口具体实现</div><div><span style="font-weight: bold;">2.开发步骤</span></div><div>  注册驱动</div><div>  获取连接</div><div>  发送sql</div><div>  获取响应</div><div>  释放资源</div><div><span style="font-weight: bold;">3.核心api</span></div><div>  1)DriverManager(类): 驱动管理器</div><div>    注册和管理驱动,获取连接,两种方法: </div><div>    DriverManager.registerDriver(new Driver());</div><div>    Class.forName(&quot;com.mysql.jdbc.Driver&quot;);</div><div>  2)Connection(java.sql,接口):与数据库连接</div><div>    DriverManager.getConnection(url,user,password);</div><div>    url(统一资源定位符 )格式:    <a href="protocol://ip:port/path?param">protocol://ip:port/path?param</a>1&amp;param2...</div><div>     </div><div>  3)Statement(java.sql.Statement,接口):发送static sql(存在sql注入危险)</div><div>    创建: conn.createStatement(sql)</div><div>    conn.execute(): 可以发送所有sql命令,查询有值true,否则为false</div><div>    conn.executeQuery():发送查询sql,返回值ResultSet</div><div>    conn.executeUpdate():发送增删改,返回值int</div><div>    conn.executeBatch():发送批处理,返回值int[]</div><div>  4)PreparedStatement(java.sql.PreparedStatement,接口):Statement的子接口,可以预编译(即可以提前优化检测语法语义)</div><div>        避免sql注入的危险</div><div>    创建: ps.prepareStatement(sql)</div><div>    赋值: ps.setter(parmeterIndex,value)     </div><div>  5)ResultSet(java.sql.<span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">ResultSet</span>,接口):代表结果集,底层维护一个指向结果集游标(cursor)</div><div>    ResultSet.next():移动游标,每次向下移动一行,开始时指向第一行的前面</div><div>    ResultSet.getter(colindex/collabel):获取字段值    </div><div><span style="font-weight: bold;">4.dao开发(面向接口的开发)</span></div><div>  javaweb经典三层: 松耦合,代码复用</div><div>    表示层:      接收请求和响应  web</div><div>    业务逻辑层:  处理具体业务   service</div><div>    数据持久层:  数据库交互     dao</div><div>  dao开发:</div><div>     面向接口</div><div>     接口+实现类</div><div>    </div><div>    </div><div><span style="font-weight: bold;">5.硬编码处理(当你的代码打成jar包发给别人用,有硬编码问题时,如何处理)</span></div><div>    硬编码问题的体现如下图</div><div><img src="day6-JdbcDemo的不断改进(包括day5也是)、dao开发、硬编码问题处理、ba_files/Image.png" type="image/png" data-filename="Image.png" width="982"/></div><div>  解决方法一般是:写成配置文件,让用户通过修改配置文件来修改给定的值: 有两种配置文件,分别是java属性文件和xml文件</div><div>  java属性文件: 后缀名为 .properties。里面是一对对的key=value键值对</div><div>  </div><div>  规范: </div><div>        先给配置文件起名为:jdbc.properties</div><div>        key:(以下为key的名字及其对应的含义)</div><div style="margin-left: 40px;">        driver:驱动</div><div style="margin-left: 40px;">        url:路径</div><div style="margin-left: 40px;">        user:用户名</div><div style="margin-left: 40px;">        passsword:密码    </div><div>    示例:</div><div>    (1)先在需要打包的项目中创建一个File类型的文件在src文件夹下,文件名就叫jdbc.properties,将其作为配置文件</div><div>        <img src="day6-JdbcDemo的不断改进(包括day5也是)、dao开发、硬编码问题处理、ba_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>    (2)在该文件里加上以下键值对</div><div>        <img src="day6-JdbcDemo的不断改进(包括day5也是)、dao开发、硬编码问题处理、ba_files/Image [2].png" type="image/png" data-filename="Image.png"/>  </div><div>    (3)调用该配置文件来给出现硬编码的地方重新赋相应的值。</div><div>    从而JdbcUtils工具类的代码变成了如下:</div><div>    <span style="color: rgb(166, 0, 196);">具体代码的详情见eclipse的workplace为&quot;F:\Java\eclipse_workplace_ALL\MySQL网课代码&quot;下的项目JdbcDemo下的util</span><span style="color: rgb(166, 0, 196);">包</span></div><div><img src="day6-JdbcDemo的不断改进(包括day5也是)、dao开发、硬编码问题处理、ba_files/Image [3].png" type="image/png" data-filename="Image.png" width="1097"/></div><div><img src="day6-JdbcDemo的不断改进(包括day5也是)、dao开发、硬编码问题处理、ba_files/Image [4].png" type="image/png" data-filename="Image.png" width="1097"/></div><div>    (4)经过以上步骤,就有效避免了打成jar包被别人引用后的硬编码问题, 引用这些代码后要修改的话,只需修改配置文件里的内容即可</div><div><br/></div><div><span style="font-weight: bold;">6.basedao开发</span></div><div>    在上面这个案例中,代码是一步步不断优化的,直到出现了basedao。BaseDao.java代码如下:</div><div>    <img src="day6-JdbcDemo的不断改进(包括day5也是)、dao开发、硬编码问题处理、ba_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div><img src="day6-JdbcDemo的不断改进(包括day5也是)、dao开发、硬编码问题处理、ba_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div><img src="day6-JdbcDemo的不断改进(包括day5也是)、dao开发、硬编码问题处理、ba_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div><img src="day6-JdbcDemo的不断改进(包括day5也是)、dao开发、硬编码问题处理、ba_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div><img src="day6-JdbcDemo的不断改进(包括day5也是)、dao开发、硬编码问题处理、ba_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>并由此对StuDaoImpl3进行改良而出现了StuDaoImpl4。如下图: 可以看出代码非常简洁。</div><div>    具体StuDaoImpl的一步步变化可以参考<span style="color: rgb(166, 0, 196);">eclipse的workplace为&quot;F:\Java\eclipse_workplace_ALL\MySQL网课代码&quot;下</span></div><div><span style="color: rgb(166, 0, 196);">        的项目JdbcDemo下</span></div><div><img src="day6-JdbcDemo的不断改进(包括day5也是)、dao开发、硬编码问题处理、ba_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div><img src="day6-JdbcDemo的不断改进(包括day5也是)、dao开发、硬编码问题处理、ba_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div>      </div><div>    </div><div>    </div><div>    </div><div>    </div><div>    </div><div>    </div><div>    </div><div>    </div><div>    </div><div>    </div><div>    </div></span>
</div></body></html> 