<html>
<head>
  <title>day7-集群环境搭建（1）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/603932 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 12pt;
    }
  </style>
</head>
<body>
<a name="958"/>
<h1>day7-集群环境搭建（1）</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2019/7/16 11:31</i></td></tr>
<tr><td><b>更新时间：</b></td><td><i>2021/4/27 18:35</i></td></tr>
</table>
</div>
<br/>

<div>
<span><div><span style="font-weight: bold;"> 一、hadoop集群简介</span></div><div><span style="font-weight: bold;"><img src="day7-集群环境搭建（1）_files/Image.png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-weight: bold;"><img src="day7-集群环境搭建（1）_files/Image [1].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-weight: bold;"><img src="day7-集群环境搭建（1）_files/Image [2].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-weight: bold;"><img src="day7-集群环境搭建（1）_files/Image [3].png" type="image/png" data-filename="Image.png"/></span></div><div><br/></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-weight: bold;">二、Hadoop集群搭建前的14个步骤：</span></div><div><br/></div><div><span style="color: rgb(255, 0, 0); font-weight: bold;"> </span><span style="color: rgb(255, 0, 0); font-weight: bold;">hadoop的</span><span style="color: rgb(255, 0, 0); font-weight: bold;">分布式集群搭建前的准备操作步骤：</span><span style="font-weight: bold;">（虚拟机版）</span></div><div><span style="font-weight: bold;">        <span style="font-weight: bold; color: rgb(166, 0, 196);">步骤1~12都是在root用户中执行，其余的才是在hadoop用户中执行</span></span></div><div><br/></div><div><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(166, 0, 196);">1、</span><span style="color: rgb(255, 0, 0);">修改主机名   vi /etc/sysconfig/network</span></div><div><span style="color: rgb(255, 0, 0);">        </span><span style="color: rgb(166, 0, 196);">2、</span><span style="color: rgb(255, 0, 0);">配置IP</span></div><div><span style="color: rgb(255, 0, 0);">            （1）修改网卡mac地址 也就是把eth0的网卡的mac地址变一下</span></div><div><span style="color: rgb(255, 0, 0);">                vi /etc/udev/rules.d/70-persistent-net.rules</span></div><div><span style="color: rgb(255, 0, 0);">                </span><span style="color: rgb(255, 0, 0);">这个一般不好直接改，一般都是</span><span style="color: rgb(166, 0, 196);">把eth0删掉了，然后直接把eth1改成了eth0</span></div><div><span style="color: rgb(255, 0, 0);">            （2）修改IP地址</span></div><div><span style="color: rgb(255, 0, 0);">                        vi /etc/sysconfig/network-scripts/ifcfg-</span><span style="color: rgb(166, 0, 196);">eth0</span></div><div><span style="color: rgb(255, 0, 0);">                        如果是</span><span style="color: rgb(166, 0, 196);">（1）中把eth0删掉了，把eth1改成了eth0</span></div><div><span style="color: rgb(255, 0, 0);">                        则把IPADDR改成想要的IP地址后，再把 UUID 和 HWADDR 这两行删掉</span></div><div><span style="color: rgb(255, 0, 0);">           </span>     如果只修改了IP地址，没有动网卡，则只需重启网络：service network restart   ，如果修改了网卡，则一</div><div>                    定要重启主机：reboot 才能生效</div><div>                顺带说一句，如果VMware中的虚拟机是克隆生成的或者是从别处复制过来的，那么即使你删除了eth0，并</div><div>                将eth1改成了eth0，那么此时VMware也会重新给你生成一个eth1，也就是再生成一张网卡，这时候就又变</div><div>                成了两张网卡，并且VMware会将eth0这张网卡弄失效，让eth1来工作（当你使用命令ifconfig的时候最前面</div><div>                就标识了现在使用的是哪张网卡），从而保证同一台主机的每个虚拟机的网卡<span style="font-size: unset; color: unset; font-family: unset;">都是独一无二的。但由于我们</span></div><div><span style="font-size: unset; color: unset; font-family: unset;">                搭建集群的方法的原因，</span><span style="font-size: unset; color: unset; font-family: unset;">这个时候我们还是要把新虚拟机的eth0删掉，然后把eth1网卡重命名为eth0，否则还</span></div><div><span style="font-size: unset; color: unset; font-family: unset;">                是会</span><span style="font-size: unset; color: unset; font-family: unset;">出现网络错误，导致该虚拟机无法正常工作。而如果是将一个拷贝过来的虚拟机</span>在第一次开启</div><div>                该虚拟机时选择“我已移动该虚拟机”而不是“我已复制该虚拟机”，则不会帮你再添加一张网卡，这个时候</div><div>                的虚拟机一切设置都会如拷贝之前的样子。所以建议如果你的虚拟机是从别处拷过来直接在<span style="color: rgb(166, 0, 196);">另一台主机</span>上使</div><div>                用，那么建议第一次开机时选择“移动”，方便直接运行虚拟机。如果是在<span style="color: rgb(166, 0, 196);">同一台主机</span>上使用的话，则</div><div>                建议使用“复制”，多生成一张网卡这也是VMware为了避免在同一台主机上会使用同一张网卡（每台</div><div>                主机的网卡都是世界上独一无二的，所以虚拟机也是如此），造成多台虚拟机网络冲突。</div><div><br/></div><div><br/></div><div>        <span style="color: rgb(255, 0, 0);">3</span><span style="color: rgb(255, 0, 0);">、配置主机映射  vi /etc/hosts   （要在里面填入所有的主机的相应映射）</span></div><div><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">   </span> 因为克隆的缘故，只要配置好一台，那么用这个配置好的虚拟机进行克隆后的所有主机都会有这张主机映射表<span style="color: rgb(255, 0, 0);"> </span></div><div><span style="color: rgb(168, 168, 168);">                ## 只要windows系统里面的配置文件hosts里主机映射地址已经写好</span></div><div><span style="color: rgb(168, 168, 168);">                ## 那么就可以在SecureCRT里面直接用主机名（如hadoop05）连上该主机</span></div><div><span style="color: rgb(168, 168, 168);">                ## 因为SecureCRT毕竟是Windows系统里的软件</span></div><div><span style="color: rgb(168, 168, 168);">                ## 所以，主机映射可以先配好一台hadoop01后，</span></div><div><span style="color: rgb(168, 168, 168);">                ## 在SecureCRT里通过“Send chat to all sessions”窗口</span></div><div><span style="color: rgb(168, 168, 168);">                ## 群发“scp -r hadoop01:/etc/hosts /etc/hosts”即可将所有主机配好主机映射</span><span style="color: rgb(168, 168, 168);">（当然这里是先</span></div><div><span style="color: rgb(168, 168, 168);">                ##虚拟出多台主机再配置主机映射的话就需要这些操作，如果是一台主机配置好再进行克隆则不需要）</span></div><div><span style="color: rgb(168, 168, 168);">                ## 当然，群发操作要在配置好免密登录之后才行</span></div><div><br/></div><div>        <span style="color: rgb(255, 0, 0);">4、 关闭selinux   vi /etc/selinux/config 设置SELINUX=disabled</span></div><div><br/></div><div><span style="color: rgb(255, 70, 53);">       </span> <span style="color: rgb(255, 0, 0);">5、添加普通用户hadoop，并且给hadoop用户添加sudoer权限</span></div><div><span style="color: rgb(255, 0, 0);">            vi /etc/sudoers</span></div><div><span style="color: rgb(255, 0, 0);">            找到 root ALL=(ALL) ALL 这一行，</span></div><div><span style="color: rgb(255, 0, 0);">            然后在他下面添加一行：</span></div><div><span style="color: rgb(255, 0, 0);">            hadoop  ALL=(ALL) ALL</span></div><div><br/></div><div><span style="color: rgb(255, 0, 0);">        </span></div><div><span style="color: rgb(255, 0, 0);">        </span><span style="color: rgb(255, 0, 0);">6、修改系统启动级别为3  vi /etc/inittab</span></div><div><br/></div><div><span style="color: rgb(255, 0, 0);">        7、 关闭防火墙开机自启 chkconfig iptables off</span></div><div><span style="color: rgb(255, 0, 0);">              </span> <span style="color: rgb(255, 0, 0);">查看防火墙状态 service iptables status</span></div><div><br/></div><div><span style="color: rgb(255, 0, 0);">       </span> <span style="color: rgb(255, 0, 0);">8、安装JDK</span></div><div><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">   </span> 要将Windows系统中的文件上传到linux，首先快捷键 <span style="color: rgb(255, 0, 0);">alt + p</span> 在SecureCRT进入到SFTP界面，当前上</div><div>                传文件的一般是放在家目录里（可以在SFTP界面用<span style="color: rgb(255, 0, 0);">pwd</span>命令查看当前文件上传的目录，其实也就是工作目录，因为</div><div>                上传文件也是直接上传到当前工作目录下），如果想上传到其他目录下可以在SFTP界面用cd命令如 <span style="color: rgb(255, 0, 0);">cd /usr/local</span> </div><div>                把工作目录转换到某个文件夹下，则上传后的文件就存放在<span style="color: rgb(255, 0, 0);">/usr/local目录下了</span></div><div><span style="color: rgb(255, 0, 0);">        （1）首先在SFTP界面上传jdk压缩包</span></div><div><span style="color: rgb(255, 0, 0);">          </span> <span style="color: rgb(26, 173, 224);">sftp&gt; </span><span style="color: rgb(255, 0, 0);">put </span><span style="color: rgb(255, 0, 0);">D:/暑假Hadoop/软件/jdk/</span><span style="color: rgb(255, 0, 0);">jdk-8u73-linux-x64.tar.gz      </span> <span style="color: rgb(168, 168, 168);">##put是从Windows上传到linux，</span></div><div><span style="color: rgb(255, 0, 0);">      </span> <span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span> <span style="color: rgb(255, 0, 0);"> </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(168, 168, 168);">##</span><span style="color: rgb(168, 168, 168);">get</span><span style="color: rgb(168, 168, 168);">是从linux下载到</span><span style="color: rgb(168, 168, 168);">Windows</span><span style="color: rgb(168, 168, 168);"> </span></div><div><span style="color: rgb(255, 0, 0);">        （2）上传完成后进行如下操作</span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span></div><div><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">mkdir /usr/local/java</span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">  </span><span style="color: rgb(168, 168, 168);">##jdk的安装需要给它建立安装目录存放安装的配置文件，mysql则不用</span></div><div><span style="color: rgb(255, 0, 0);">                </span><span style="color: rgb(255, 0, 0);">tar -zxvf</span> <span style="color: rgb(77, 206, 29);">/usr/local/jdk-8u73-linux-x64.tar.gz</span> <span style="color: rgb(255, 0, 0);">-C /usr/local/java/    </span></div><div><span style="color: rgb(255, 0, 0);">                </span><span style="color: rgb(255, 0, 0);">vi /etc/profile</span></div><div><span style="color: rgb(255, 0, 0);">                            在该文件最后加入两行代码：</span></div><div><span style="color: rgb(255, 0, 0);">                            export JAVA_HOME=/usr/local//java/</span><span style="color: rgb(107, 231, 72);">jdk1.8.0_73</span><span style="color: rgb(255, 0, 0);"> </span> </div><div><span style="color: rgb(255, 0, 0);">                            export PATH=$PATH:$JAVA_HOME/bin</span></div><div><span style="color: rgb(255, 0, 0);">                </span><span style="color: rgb(255, 0, 0);">source /etc/profile</span></div><div><span style="color: rgb(255, 0, 0);">                java -version               </span><span style="color: rgb(168, 168, 168);">#检测 jdk 是否安装成功</span></div><div><span style="color: rgb(255, 0, 0);">   </span></div><div><br/></div><div><br/></div><div><span style="color: rgb(255, 0, 0);">        </span><span style="color: rgb(255, 0, 0);">9、安装一下MySQL          </span><span style="color: rgb(168, 168, 168);">##绿色字体视文件或文件夹名称而变；蓝色字体表示输入窗口本就存在的内                                                                                         ##容，不需输入，只是提醒一下此处输入时前缀有这些字符</span></div><div><span style="color: rgb(255, 0, 0);">            采用rpm方式安装</span></div><div><span style="color: rgb(255, 0, 0);">          （1）</span><span style="color: rgb(255, 0, 0);">、 检查以前是否原先装过或预装了MySQL</span><span style="color: rgb(255, 0, 0);">           </span><span style="color: rgb(255, 0, 0);">rpm -qa|grep -i mysql</span></div><div><span style="color: rgb(255, 0, 0);">          </span><span style="color: rgb(255, 0, 0);">（2）、 发现有的话就都卸载:                   </span><span style="color: rgb(255, 0, 0);">rpm -e --nodeps</span> <span style="color: rgb(77, 206, 29);">mysql-libs-5.1.73-5.el6_6.x86_64</span></div><div><img src="day7-集群环境搭建（1）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>          <span style="color: rgb(255, 0, 0);">（3）</span><span style="color: rgb(255, 0, 0);">、 删除老版本 mysql 的开发头文件和库</span></div><div><span style="color: rgb(255, 0, 0);">                                    rm -rf /usr/lib/mysql</span></div><div><span style="color: rgb(255, 0, 0);">                                    rm -rf /usr/include/mysql</span></div><div><span style="color: rgb(255, 0, 0);">                                    rm -rf /etc/my.cnf</span></div><div><span style="color: rgb(255, 0, 0);">                                    rm -rf /var/lib/mysql</span></div><div><span style="color: rgb(255, 0, 0);">         </span> <span style="color: rgb(255, 0, 0);">（4）</span><span style="color: rgb(255, 0, 0);">在SecureCRT按 alt+p 键进入SFTP文件传输界面</span></div><div><span style="color: rgb(255, 0, 0);">                </span><span style="color: rgb(26, 173, 224);">sftp&gt;</span> <span style="color: rgb(255, 0, 0);">put</span> <span style="color: rgb(77, 206, 29);">d:/暑假Hadoop/软件/MySQL-5.6.45-1.el6.x86_64.rpm-bundle.tar</span></div><div><span style="color: rgb(255, 0, 0);">         </span> <span style="color: rgb(255, 0, 0);">（5）</span><span style="color: rgb(255, 0, 0);">解压：        </span><span style="color: rgb(255, 0, 0);">tar -</span><span style="color: rgb(166, 0, 196);">xvf</span> <span style="color: rgb(77, 206, 29);">MySQL-5.6.45-1.el6.x86_64.rpm-bundle.tar</span></div><div><span style="color: rgb(255, 0, 0);">                </span><span style="color: rgb(168, 168, 168);">     ##jdk的安装需要给它建立安装目录存放安装的配置文件，mysql则不用</span></div><div>                   解压后只需安装server和client即可，解压后如图</div><div><img src="day7-集群环境搭建（1）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div><span style="color: rgb(255, 0, 0);">         </span> <span style="color: rgb(255, 0, 0);">（6）</span><span style="color: rgb(255, 0, 0);">安装server（也就是服务器）         </span><span style="color: rgb(255, 0, 0);">rpm -ivh</span> <span style="color: rgb(77, 206, 29);">MySQL-server-5.6.45-1.el6.x86_64.rpm</span></div><div><span style="color: rgb(255, 0, 0);">        </span>安装成功时会提示系统随机生成的密码放在哪里，在安装完成时的最后一页会有提示，如图：</div><div><img src="day7-集群环境搭建（1）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div><span style="color: rgb(255, 0, 0);">         </span> <span style="color: rgb(255, 0, 0);">（7）</span><span style="color: rgb(255, 0, 0);">安装client（也就是客户端）          </span><span style="color: rgb(255, 0, 0);">rpm -ivh</span> <span style="color: rgb(77, 206, 29);">MySQL-client-5.6.45-1.el6.x86_64.rpm</span></div><div><span style="color: rgb(255, 0, 0);">         </span> <span style="color: rgb(255, 0, 0);">（8）</span><span style="color: rgb(255, 0, 0);">启动mysql服务                             </span><span style="color: rgb(255, 0, 0);">service mysql start</span></div><div><span style="color: rgb(255, 0, 0);">         </span> <span style="color: rgb(255, 0, 0);">（9）</span><span style="color: rgb(255, 0, 0);">修改root用户的登录密码                </span></div><div><span style="color: rgb(255, 0, 0);">                  a、首先要找到安装时系统随机生成的密码：    </span><span style="color: rgb(255, 0, 0);">cat /root/.mysql_secret</span></div><div><img src="day7-集群环境搭建（1）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div><span style="color: rgb(255, 0, 0);">                  b、复制该密码，并使用该随机密码登录            </span></div><div><span style="color: rgb(255, 0, 0);">                        mysql -uroot -p</span><span style="color: rgb(77, 206, 29);">zOMdjv4V4a__fDQB   </span><span style="color: rgb(168, 168, 168);">#注意:-p和密码之间不能有空格,-u和用户名之间可有可无</span></div><div><img src="day7-集群环境搭建（1）_files/Image [8].png" type="image/png" data-filename="Image.png" width="1189"/></div><div><span style="color: rgb(168, 168, 168);">    </span><span style="color: rgb(168, 168, 168);">    </span><span style="color: rgb(168, 168, 168);">    </span><span style="color: rgb(168, 168, 168);">    </span><span style="color: rgb(168, 168, 168);"> </span> <span style="color: rgb(255, 0, 0);">c、登录后，在登录状态下用mysql语句修改密码并退出:</span></div><div><span style="color: rgb(255, 0, 0);">                                  </span><span style="color: rgb(26, 173, 224);">mysql&gt;</span> <span style="color: rgb(255, 0, 0);">set PASSWORD=</span><span style="color: rgb(255, 0, 0);">PASSWORD</span><span style="color: rgb(255, 0, 0);">(&quot;root&quot;);</span></div><div><span style="color: rgb(255, 0, 0);">                                  </span><span style="color: rgb(26, 173, 224);">mysql&gt;</span> <span style="color: rgb(255, 0, 0);">exit；</span><span style="color: rgb(255, 0, 0);"> </span></div><div><span style="color: rgb(255, 0, 0);">        （10）用新密码登录，验证密码</span><span style="color: rgb(255, 0, 0);">是否改密码成功，登录后赋予root用户在其他主机上的</span><span style="color: rgb(255, 0, 0);">远程登陆权限</span><span style="color: rgb(255, 0, 0);">，并刷新</span></div><div style="margin-left: 120px;"><span style="color: rgb(255, 0, 0);">  </span> <span style="font-size: unset; color: rgb(166, 0, 196); font-family: unset;">（</span><span style="color: rgb(166, 0, 196);">如果赋予了某虚拟机远程登陆权限，则可以直接在Windows上用主机名或网关分配的ip地址就能连接该虚拟机的mysql，如果没有</span><span style="font-size: unset; color: rgb(166, 0, 196); font-family: unset;">设置远程登录权限，则在Windows上连接不了该虚拟机的mysql，该虚拟机里的mysql只能被该虚拟机</span><span style="font-size: unset; color: rgb(166, 0, 196); font-family: unset;">自己的某软件通过网卡上的本机回环地址连接。Windows系统上的mysql也是一样的，如果没有远程登录权限，则不能被其他主机访问，也不能在自己主机上直接用网关分配的ip地址登录，因为网关分配的ip是由路由器给的，连接mysql的软件访问网卡，网卡还要访问路由器，这种间接得到ip地址的方式也是远程登录）</span></div><div><span style="color: rgb(255, 0, 0);">                          </span><span style="color: rgb(255, 0, 0);">mysql -uroot -proot</span></div><div><span style="color: rgb(255, 0, 0);">             </span><span style="color: rgb(26, 173, 224);">mysql&gt;</span> <span style="color: rgb(255, 0, 0);">GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'root' WITH GRANT OPTION;</span></div><div><span style="color: rgb(255, 0, 0);">             </span><span style="color: rgb(26, 173, 224);">mysql&gt;</span> <span style="color: rgb(255, 0, 0);">FLUSH PRIVILEGES;          </span><span style="color: rgb(168, 168, 168);">#这一行意思是刷新，刷新后，赋予的权限才会生效</span></div><div><img src="day7-集群环境搭建（1）_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><span style="color: rgb(255, 0, 0);">        10、克隆</span></div><div>                执行完第九步，形成了一台虚拟机后，就进行克隆，照着这台虚拟机克隆出自己想要的虚拟机个数，克</div><div>                   隆形成的主机已经具有了安装步骤中3、4、5、6、7、8、9、中的所有特性，所以，只需要在每台虚拟</div><div>                   机上都单独执行一下1、2、两步，改一下主机名，改一下IP地址和网卡即可</div><div><br/></div><div><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    11、在每台克隆出来的虚拟机上只重复执行</span><span style="color: rgb(209, 0, 255);">1、2、</span><span style="color: rgb(255, 0, 0);">两步，直到把所有虚拟机的主机名、IP地址和网卡修改完</span></div><div><span style="color: rgb(255, 0, 0);">                成，每台虚拟机改完网卡都要重启主机</span></div><div><br/></div><div><span style="color: rgb(255, 0, 0);">        12、在Windows系统中配置主机映射，连接SecureCRT</span><span style="color: rgb(166, 0, 196);">（</span><span style="color: rgb(166, 0, 196);">同时创建root和hadoop用户的连接</span><span style="color: rgb(166, 0, 196);">）</span><span style="color: rgb(255, 0, 0);"> </span></div><div><span style="color: rgb(255, 0, 0);">                配置主机映射的路径是：</span><span style="color: rgb(255, 0, 0);">C:\Windows\System32\drivers\etc\hosts</span></div><div><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">   </span>（ Windows的路径中，查找文件时或者输入储存路径时输入斜杠&quot;/&quot;和反斜杠&quot;\&quot;都可被识别，而linux只</div><div>                    支持斜杠&quot;/&quot; ）</div><div><br/></div><div><span style="color: rgb(166, 0, 196); font-weight: bold;">    </span><span style="color: rgb(166, 0, 196); font-weight: bold;"> 注意：前面的12个步骤全部都是在root用户下执行的命令，包括第13个命令也可能需要在root用户执行</span></div><div><br/></div><div>    <span style="font-weight: bold;">以下的操作是在连接上windows的SecureCRT后，把所有主机放在一个窗口，通过“Send chat to all</span><span style="font-weight: bold;">sessions”来群发完成</span></div><div><br/></div><div><span style="color: rgb(255, 0, 0);">        13、同步所有服务器的时间</span></div><div><span style="color: rgb(255, 0, 0);">            (1)</span><span style="color: rgb(255, 0, 0);">更改时区： </span><span style="color: rgb(255, 0, 0);">cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime   </span><span style="color: rgb(255, 0, 0);"> </span>(如果没有 Asia/Shanghai</div><div>                         时区文件，请使用 tzselect 命令去生成时区文件，生成好的时区文件就在/usr/share/zoneinfo 目录下)</div><div><span style="color: rgb(255, 0, 0);">            </span><span style="color: rgb(255, 0, 0);">(2)</span><span style="color: rgb(255, 0, 0);">修改系统时间： </span><span style="color: rgb(255, 0, 0);">date -s &quot;2016-12-25 09:57:30&quot;</span></div><div>            <span style="color: rgb(255, 0, 0);">(3)</span><span style="color: rgb(255, 0, 0);">将修改好的时间写入到主板的计时器中去： hwclock -w</span>  (手动修改系统时间后，一般都会将时间固化</div><div>                        到主板的计时器中，以防止随着服务器的使用，过了一段时间就导致系统时间误差太大。<span style="color: rgb(166, 0, 196);">修改时间</span></div><div><span style="color: rgb(166, 0, 196);">    </span><span style="color: rgb(166, 0, 196);">    </span><span style="color: rgb(166, 0, 196);">    </span><span style="color: rgb(166, 0, 196);">    </span><span style="color: rgb(166, 0, 196);">    </span><span style="color: rgb(166, 0, 196);">    </span><span style="color: rgb(166, 0, 196);">后，需要写入硬件 bios 才能在重启之后依然生效</span>）</div><div><br/></div><div><span style="color: rgb(255, 0, 0);">        14、配置SSH免密登录<span style="color: rgb(255, 0, 0);">（</span></span><span style="color: rgb(166, 0, 196);">首先要确保所有服务器已经将登录用户切换为</span><font style="color: rgb(166, 0, 196);"><b>hadoop</b></font><span style="color: rgb(166, 0, 196);">, 因为Hadoop集群</span><span style="color: rgb(166, 0, 196);">一般都搭建在普通用户上，而不是root用户</span><span style="color: rgb(255, 0, 0);">）</span></div><div style="margin-left: 40px;"><span style="color: rgb(166, 0, 196); font-weight: bold;">         如果是配置root用户的免密登录，则下面的配置免密登录的命令中所有</span><span style="color: rgb(166, 0, 196); font-weight: bold;">的</span><span style="font-weight: bold;"><font style="color: rgb(77, 206, 29);">绿色字体</font></span><span style="color: rgb(166, 0, 196); font-weight: bold;">的</span><span style="color: rgb(166, 0, 196); font-weight: bold;">“</span><span style="color: rgb(166, 0, 196); font-weight: bold;">/home/hadoop</span><span style="color: rgb(166, 0, 196); font-weight: bold;">”改为“</span><span style="color: rgb(166, 0, 196); font-weight: bold;">/root</span><span style="color: rgb(166, 0, 196); font-weight: bold;">”</span><span style="color: rgb(166, 0, 196); font-weight: bold;">，</span><span style="color: rgb(166, 0, 196); font-weight: bold;">“hadoop</span><span style="color: rgb(166, 0, 196); font-weight: bold;">”则改为“</span><span style="color: rgb(166, 0, 196); font-weight: bold;">root</span><span style="color: rgb(166, 0, 196); font-weight: bold;">”</span></div><div><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);"> </span> 配置之前如果有主机配置过了要首先删除 <span style="color: rgb(255, 0, 0);">在&quot;Send chat to all sessions&quot;窗口输入 </span>rm -rf <span style="color: rgb(77, 206, 29);">/home/hadoop</span>/.ssh  </div><div><span style="color: rgb(255, 0, 0);">                （1</span><span style="color: rgb(255, 0, 0);">）在&quot;Send chat to all sessions&quot;窗口输入ssh-keygen -t rsa 来生成基于rsa非对称加密算法的一对</span></div><div><span style="color: rgb(255, 0, 0);">                       秘钥，三次回车秘钥即可生成完毕</span></div><div><span style="color: rgb(255, 0, 0);">                （2）在&quot;Send chat to all sessions&quot;窗口使用 ssh-copy-id</span> <font style="color: rgb(77, 206, 29);">hadoop</font><span style="color: rgb(255, 0, 0);">@hadoop01 命令,该命令会将所有主</span></div><div><span style="color: rgb(255, 0, 0);">                        机(包括hadoop01自己)的公钥发送到hadoop01的</span><span style="color: rgb(77, 206, 29);">/home/hadoop</span><span style="color: rgb(255, 0, 0);">/.ssh/authorized_keys文件中去，</span></div><div><span style="color: rgb(255, 0, 0);"><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span>并且不会覆盖之前的文件内容，也就是说hadoop01里面会存有所有主机的公钥</span></div><div><span style="color: rgb(255, 0, 0);">                （3）再</span><span style="color: rgb(255, 0, 0);">在&quot;Send chat to all sessions&quot;窗口输入命令:</span><span style="color: rgb(255, 0, 0);"> </span></div><div><span style="color: rgb(255, 0, 0);"><span>    </span><span>    </span><span>    </span><span>    </span><span>    <span>    </span></span>scp -r </span><span style="color: rgb(77, 206, 29);">hadoop</span><span style="color: rgb(255, 0, 0);">@</span><span style="color: rgb(255, 0, 0);">hadoop01:</span><span style="color: rgb(77, 206, 29);">/home/hadoop</span><span style="color: rgb(255, 0, 0);">/.ssh/authorized_keys</span> <span style="color: rgb(77, 206, 29);">/home/hadoop</span><span style="color: rgb(255, 0, 0);">/.ssh/authorized_keys</span></div><div><span style="color: rgb(255, 0, 0);"><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span>即可把所有主机的公钥文件替换成hadoop01中的公钥文件，从而以后所有主机之间传输文</span><span style="color: rgb(255, 0, 0);">件都不用再输入密码</span></div><div><br/></div><div><span style="color: rgb(166, 0, 196);">”@“符号的用法</span>：（形式：用户名@主机名）</div><div style="margin-left: 40px;">       root@hadoop01或者hadoop@hadoop01，如果只写成hadoop01，省略@和其前面的用户名，并且当前服务器要发送文件给hadoop01或者从hadoop01获取文件的话，就表示和hadoop01进行通信的是和当前服务器登录的用户一样的用户。也就是说，当前服务器登录的是root，那么当前服务器执行这条命令时就是请求和hadoop01的root用户进行通信，如果当前服务器登录的是hadoop用户，那么就表示请求和hadoop01的hadoop用户进行通信。而不是说 省略@和其前面的用户名的话，就默认是root用户，这是错误的观点。           </div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><span style="color: rgb(255, 0, 0); font-weight: bold;">hadoop的全</span><span style="color: rgb(255, 0, 0); font-weight: bold;">分布式</span><span style="color: rgb(255, 0, 0); font-weight: bold;">集群搭建前的</span><span style="color: rgb(255, 0, 0); font-weight: bold;">准备操作步骤：（</span><span style="font-weight: bold;">多台</span><span style="font-weight: bold;">真实主机版</span><span style="color: rgb(255, 0, 0); font-weight: bold;">）</span></div><div><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(166, 0, 196);">1、</span><span style="color: rgb(255, 0, 0);">修改主机名   vi /etc/sysconfig/network</span></div><div><br/></div><div><span style="color: rgb(255, 0, 0);">        </span><span style="color: rgb(166, 0, 196);">2、</span><span style="color: rgb(255, 0, 0);">配置IP</span></div><div><span style="color: rgb(255, 0, 0);">            </span> 全分布式（1）不用，因为不同的主机，其网卡必然是不一样的，全世界的每块网卡都是唯一的，有唯一的mac</div><div><span style="color: rgb(255, 0, 0);">           </span> <span style="color: rgb(168, 168, 168);">##</span><span style="color: rgb(168, 168, 168); font-weight: bold; text-decoration: underline;">（1）</span><span style="color: rgb(168, 168, 168);">修改网卡mac地址 也就是把eth0的网卡的mac地址变一下</span></div><div><span style="color: rgb(168, 168, 168);">            ## vi /etc/udev/rules.d/70-persistent-net.rules</span></div><div><span style="color: rgb(255, 0, 0);">             只需修改IP地址</span></div><div><span style="color: rgb(255, 0, 0);">                vi /etc/sysconfig/network-scripts/ifcfg-eth0</span></div><div><span style="color: rgb(255, 0, 0);">               </span> <span style="color: rgb(168, 168, 168);">## a. 如果是（1）中把eth0删掉了，把eth1改成了eth0</span></div><div><span style="color: rgb(168, 168, 168);">                ##   则把IPADDR改成想要的IP地址后，再把 UUID 和 HWADDR 这两行删掉</span></div><div><span style="color: rgb(255, 0, 0);">           </span> 如果只修改了IP地址，没有动网卡，则只需重启网络：service network restart   ，如果修改了网卡，则一</div><div>                定要重启主机：reboot 才能生效</div><div><br/></div><div>        <span style="color: rgb(168, 168, 168);">3、在Windows系统中配置主机映射，连接SecureCRT    路径：C:\Windows\System32\drivers\etc\hosts</span></div><div><span style="color: rgb(168, 168, 168);">     以下的操作可以在连接上windows的SecureCRT后，把尽可能多的主机放在一个窗口，当然这个时候不是通过“Send chat to all sessions”来群发 ，而是一个一个小窗口的依次操作，操作完一个立马鼠标移到下一个，（如操作完hadoop01之后，鼠标马上点到hadoop02进行同样的操作，依次进行）。这样效率也高</span></div><div><span style="color: rgb(168, 168, 168);">     如果该集群不连接SecureCRT，则以下操作只能全在每台机器屏幕的黑窗口依次执行一遍</span></div><div><span style="color: rgb(255, 0, 0);">        </span><span style="color: rgb(255, 0, 0);">3、配置一台主机映射  vi /etc/hosts  </span></div><div><span style="color: rgb(255, 0, 0);">                </span>只要windows系统里面的配置文件hosts里主机映射地址已经写好， 那么就可以在SecureCRT里</div><div>                面直接用主机名（如hadoop05）连上该主机。因为windows系统里配置的主机映射就是</div><div>                给SecureCRT用的，因为SecureCRT是Windows系统里的软件。</div><div>             （所以，主机映射可以先配好一台hadoop01后，</div><div>                在SecureCRT里通过“Send chat to all sessions”窗口</div><div>               <span style="color: rgb(168, 168, 168);"> </span><span style="color: rgb(168, 168, 168);">群发“scp -r</span> <span style="color: rgb(255, 0, 0);">192.168.123.101</span><span style="color: rgb(168, 168, 168);">:/etc/hosts /etc/hosts”即可</span><span style="color: rgb(77, 206, 29);">(注意：全分布式不能直接用hadoop01代</span></div><div><span style="color: rgb(77, 206, 29);">                    替</span><span style="color: rgb(77, 206, 29);">192.168.123.101，因为其他主机还没有配好主机映射，并不知道hadoop01是什么东西）</span></div><div>                    当然，这要在配置SSH好免密登录之后）</div><div><span style="color: rgb(255, 0, 0);">        4、 关闭selinux   vi /etc/selinux/config 设置SELINUX=disabled</span></div><div><br/></div><div>        <span style="color: rgb(255, 0, 0);">5、添加普通用户hadoop，并且给hadoop用户添加sudoer权限</span></div><div><span style="color: rgb(255, 0, 0);">            vi /etc/sudoers</span></div><div><span style="color: rgb(255, 0, 0);">            找到 root ALL=(ALL) ALL 这一行，</span></div><div><span style="color: rgb(255, 0, 0);">            然后在他下面添加一行：</span></div><div><span style="color: rgb(255, 0, 0);">            hadoop  ALL=(ALL) ALL</span></div><div><br/></div><div><span style="color: rgb(255, 0, 0);">        </span><span style="color: rgb(255, 0, 0);">6、修改系统启动级别为3  vi /etc/inittab</span></div><div><span style="color: rgb(255, 0, 0);">        </span><span style="color: rgb(255, 0, 0);">7、安装JDK</span></div><div><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">   </span> 要将Windows系统中的文件上传到linux，首先快捷键 <span style="color: rgb(255, 0, 0);">alt + p</span> 在SecureCRT进入到SFTP界面，当前上</div><div>                传文件的一般是放在家目录里（可以用<span style="color: rgb(255, 0, 0);">pwd</span>命令查看当前文件上传的目录，其实也就是工作目录，因为</div><div>                上传文件也是直接上传到当前工作目录下），如果想上传到其他目录下可以用cd命令如 <span style="color: rgb(255, 0, 0);">cd /usr/local</span> </div><div>                把工作目录转换到某个文件夹下，则上传后的文件就存放在<span style="color: rgb(255, 0, 0);">/usr/local目录下了</span></div><div><span style="color: rgb(255, 0, 0);">          （1）首先在SFTP界面上传jdk压缩包</span></div><div><span style="color: rgb(255, 0, 0);">          </span>     <span style="color: rgb(26, 173, 224);">sftp&gt; </span><span style="color: rgb(255, 0, 0);">put </span><span style="color: rgb(255, 0, 0);">D:/暑假Hadoop/软件/jdk/</span><span style="color: rgb(255, 0, 0);">jdk-8u73-linux-x64.tar.gz </span> <span style="color: rgb(168, 168, 168);">##put是从Windows上传到linux， </span></div><div><span style="color: rgb(255, 0, 0);">                                                                                                               </span> <span style="color: rgb(255, 0, 0);">     </span><span style="color: rgb(168, 168, 168);">##</span><span style="color: rgb(168, 168, 168);">get</span><span style="color: rgb(168, 168, 168);">是从linux下载到</span><span style="color: rgb(168, 168, 168);">Windows</span><span style="color: rgb(168, 168, 168);"> </span></div><div><span style="color: rgb(255, 0, 0);">          （2）上传完成后进行如下操作</span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span></div><div><span style="color: rgb(255, 0, 0);">                mkdir /usr/local/java</span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">  </span><span style="color: rgb(168, 168, 168);">##jdk的安装需要给它建立安装目录存放安装的配置文件，mysql则不用</span></div><div><span style="color: rgb(255, 0, 0);">                </span><span style="color: rgb(255, 0, 0);">tar -zxvf</span> <span style="color: rgb(255, 0, 0);">/usr/local/</span><span style="color: rgb(77, 206, 29);">jdk-8u73-linux-x64.tar.gz</span> <span style="color: rgb(255, 0, 0);">-C /usr/local/java    </span></div><div><span style="color: rgb(255, 0, 0);">                </span><span style="color: rgb(255, 0, 0);">vi /etc/profile</span></div><div><span style="color: rgb(255, 0, 0);">                            在该文件最后加入两行代码：</span></div><div><span style="color: rgb(255, 0, 0);">                            export JAVA_HOME=/usr/local//java/</span><span style="color: rgb(107, 231, 72);">jdk1.8.0_73</span><span style="color: rgb(255, 0, 0);"> </span> </div><div><span style="color: rgb(255, 0, 0);">                            export PATH=$PATH:$JAVA_HOME/bin</span></div><div><span style="color: rgb(255, 0, 0);">                </span><span style="color: rgb(255, 0, 0);">source /etc/profile</span></div><div><br/></div><div><span style="color: rgb(255, 0, 0);">        8、换一台主机，只</span><span style="color: rgb(255, 0, 0);">重复</span><span style="color: rgb(166, 0, 196);">1、2、</span><span style="color: rgb(255, 0, 0);">两步，并</span><span style="color: rgb(255, 0, 0);">在所有主机</span><span style="color: rgb(255, 0, 0);">机上只</span><span style="color: rgb(255, 0, 0);">重复1、2、两步，</span><span style="color: rgb(255, 0, 0);">直到所有主机的主机名、IP地</span></div><div><span style="color: rgb(255, 0, 0);">                 址修改完成，每台主机改完无需重启，但可能要重启网络</span><span style="color: rgb(255, 0, 0);">    </span></div><div>        </div><div>        <span style="color: rgb(255, 0, 0);">9、</span><span style="color: rgb(255, 0, 0);">在Windows系统中配置主机映射，连接SecureCRT </span><span style="color: rgb(166, 0, 196);">（</span><span style="color: rgb(166, 0, 196);">同时创建root和hadoop用户的连接</span><span style="color: rgb(166, 0, 196);">）</span></div><div><span style="color: rgb(255, 0, 0);">             配置主机映射的</span><span style="color: rgb(255, 0, 0);">路径是：</span><span style="color: rgb(255, 0, 0);">C:\Windows\System32\drivers\etc\hosts</span></div><div><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">   </span>（ Windows的路径中，查找文件时或者输入储存路径时输入斜杠&quot;/&quot;和反斜杠&quot;\&quot;都可被识别，而linux只</div><div>                    支持斜杠&quot;/&quot; ）</div><div><br/></div><div>    <span style="font-weight: bold;">以下的操作是在连接上windows的SecureCRT后，把所有主机放在一个窗口，通过“Send chat to all </span><span style="font-weight: bold;">sessions”来群发完成</span></div><div><br/></div><div><span style="color: rgb(255, 0, 0);">        10、关闭防火墙开机自启 chkconfig iptables off </span></div><div><span style="color: rgb(255, 0, 0);">                查看防火墙状态 service iptables status</span></div><div><br/></div><div><span style="color: rgb(166, 0, 196); font-weight: bold;">注意：前面的10个步骤全部都是在root用户下执行的命令，包括第11个命令也可能需要在root用户执行</span></div><div><br/></div><div>        <span style="color: rgb(255, 0, 0);">11、</span><span style="color: rgb(255, 0, 0);">同步所有服务器的时间</span></div><div><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">  </span> <span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);"> (1)</span><span style="color: rgb(255, 0, 0);">更改时区： </span><span style="color: rgb(255, 0, 0);">cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime   </span><span style="color: rgb(255, 0, 0);"> </span>(如果没有 Asia/Shanghai</div><div>                         时区文件，请使用 tzselect 命令去生成时区文件，生成好的时区文件就在/usr/share/zoneinfo 目录下)</div><div><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">(2)</span><span style="color: rgb(255, 0, 0);">修改系统时间： </span><span style="color: rgb(255, 0, 0);">date -s &quot;2016-12-25 09:57:30&quot;</span></div><div>            <span style="color: rgb(255, 0, 0);">(3)</span><span style="color: rgb(255, 0, 0);">将修改好的时间写入到主板的计时器中去： hwclock -w</span>  (手动修改系统时间后，一般都会将时间固化</div><div>                        到主板的计时器中，以防止随着服务器的使用，过了一段时间就导致系统时间误差太大。<span style="color: rgb(166, 0, 196);">修改时间</span></div><div><span style="color: rgb(166, 0, 196);">                        后，需要写入硬件 bios 才能在重启之后依然生效</span>）</div><div><br/></div><div><span style="color: rgb(255, 0, 0);">        </span><span style="color: rgb(255, 0, 0);">12、</span><span style="color: rgb(255, 0, 0);">配置SSH免密登录</span><span style="color: rgb(255, 0, 0); font-weight: bold;">（</span><span style="color: rgb(166, 0, 196); font-weight: bold;">首先要确保所有服务器已经将登录用户切换为hadoop, 因为Hadoop集群</span></div><div><span style="color: rgb(166, 0, 196); font-weight: bold;">                                            一般都搭建在普通用户上，而不是root用户</span><span style="color: rgb(255, 0, 0); font-weight: bold;">）</span></div><div style="margin-left: 40px;"><span style="color: rgb(166, 0, 196); font-weight: bold;">         </span><span style="color: rgb(166, 0, 196); font-weight: bold;">如果是配置hadoop用户的免密登录，则下面的配置免密登录的命令中所有</span></div><div style="margin-left: 40px;"><span style="color: rgb(166, 0, 196); font-weight: bold;">            的</span><span style="color: rgb(166, 0, 196); font-weight: bold;">“</span><span style="color: rgb(166, 0, 196); font-weight: bold;">/root”改为“/home/hadoop</span><span style="color: rgb(166, 0, 196); font-weight: bold;">”</span><span style="color: rgb(166, 0, 196); font-weight: bold;">，</span><span style="color: rgb(166, 0, 196); font-weight: bold;">“</span><span style="color: rgb(166, 0, 196); font-weight: bold;">root”则改为“hadoop</span><span style="color: rgb(166, 0, 196); font-weight: bold;">”</span></div><div><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);"> </span> 配置之前如果有主机配置过了要首先删除： rm -rf <span style="color: rgb(77, 206, 29);">/</span><span style="color: rgb(77, 206, 29);">root</span>/.ssh  </div><div><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    （1</span><span style="color: rgb(255, 0, 0);">）在&quot;Send chat to all sessions&quot;窗口输入ssh-keygen -t rsa 来生成基于rsa非对称加密算法的一对</span></div><div><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">  </span> <span style="color: rgb(255, 0, 0);">秘钥，三次回车秘钥即可生成完毕</span></div><div style="margin-left: 80px;"><span style="color: rgb(255, 0, 0);">（2）在&quot;Send chat to all sessions&quot;窗口使用</span> <span style="color: rgb(255, 0, 0);">ssh-copy-id</span> <span style="color: rgb(77, 206, 29);">root</span><span style="color: rgb(255, 0, 0);">@</span><span style="color: rgb(168, 168, 168);">192.168.123.101</span> <span style="color: rgb(255, 0, 0);">命令,</span><span style="color: rgb(166, 0, 196);">（不能直接用</span></div><div style="margin-left: 80px;"><span style="color: rgb(166, 0, 196);">       </span><span style="color: rgb(166, 0, 196);">hadoop01 代替</span><span style="color: rgb(168, 168, 168);">192.168.123.101</span><span style="color: rgb(166, 0, 196);">）</span><span style="color: rgb(255, 0, 0);">该命令会将所有主机的公</span><span style="color: rgb(255, 0, 0);">钥发送到hadoop01                                                           </span></div><div style="margin-left: 80px;"><span style="color: rgb(255, 0, 0);">       的</span><span style="color: rgb(77, 206, 29);">/root</span><span style="color: rgb(255, 0, 0);">/.ssh/authorized_keys文件中去，并且不会覆盖之前的文件内容，也</span><span style="color: rgb(255, 0, 0);">就是说hadoop01里面</span></div><div style="margin-left: 80px;"><span style="color: rgb(255, 0, 0);">        会存有所有主机的公钥</span></div><div><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">（3）再输入 scp -r</span> <span style="color: rgb(77, 206, 29);">root</span><span style="color: rgb(255, 0, 0);">@</span><span style="color: rgb(168, 168, 168);">192.168.123.101</span><span style="color: rgb(255, 0, 0);">:</span><span style="color: rgb(77, 206, 29);">/root</span><span style="color: rgb(255, 0, 0);">/.ssh/authorized_keys</span> <span style="color: rgb(77, 206, 29);">/root</span><span style="color: rgb(255, 0, 0);">/.ssh/authorized_keys</span></div><div><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);">    </span><span style="color: rgb(255, 0, 0);"> </span><span style="color: rgb(255, 0, 0);">命令，</span><span style="color: rgb(166, 0, 196);">（不能直接用 hadoop01代替</span><span style="color: rgb(168, 168, 168);">192.168.123.101</span><span style="color: rgb(166, 0, 196);">）</span><span style="color: rgb(255, 0, 0);">即可把所有主机的公钥文件替换成                                            </span></div><div><span style="color: rgb(255, 0, 0);">                      hadoop01中的公钥文件，从而以后所有主机之间传输文</span><span style="color: rgb(255, 0, 0);">件都不用再输入密码</span></div><div><br/></div><div><span style="color: rgb(166, 0, 196);">@符号的用法</span>：（形式：用户名@主机名）</div><div>       root@hadoop01或者hadoop@hadoop01，如果只写成hadoop01，省略@和其前面的用户名，当前服务器要发送文件给hadoop01或者从hadoop01获取文件的话，就表示和hadoop01进行通信的是和当前服务器登录的用户一样的用户。也就是说，当前服务器登录的是root，那么当前服务器执行这条命令时就是请求和hadoop01的root用户进行通信，如果当前服务器登录的是hadoop用户，那么就表示请求和hadoop01的hadoop用户进行通信。而不是说 省略@和其前面的用户名的话，就默认是root用户，这是错误的观点   </div><div><span style="color: rgb(255, 0, 0);">   </span></div><div><span style="color: rgb(255, 0, 0);">        13、群发3、4、5、6、中的所有配置文件</span></div><div><span style="color: rgb(255, 0, 0);">              </span> <span style="color: rgb(166, 0, 196);"> (注意：全分布式不能直接用hadoop01代替192.168.123.101，因为其他主机还没有配好主机映射，并</span></div><div><span style="color: rgb(166, 0, 196);">                    不知道hadoop01是什么东西）</span></div><div><span style="color: rgb(168, 168, 168);">            ##scp -r hadoop01:/etc/hosts /etc/hosts</span></div><div><span style="color: rgb(168, 168, 168);">            ##scp -r hadoop01:/etc/selinux/config /etc/selinux/config</span></div><div><span style="color: rgb(168, 168, 168);">            ##scp -r hadoop01:/etc/sudoers /etc/sudoers</span></div><div><span style="color: rgb(168, 168, 168);">            ##scp -r hadoop01:/etc/inittab /etc/inittab</span></div><div><span style="color: rgb(255, 0, 0);">                scp -r</span> <span style="color: rgb(166, 0, 196);">192.168.123.101</span><span style="color: rgb(255, 0, 0);">:/etc/hosts /etc/hosts</span></div><div><span style="color: rgb(255, 0, 0);">                </span><span style="color: rgb(255, 0, 0);">scp -r</span> <span style="color: rgb(166, 0, 196);">192.168.123.101</span><span style="color: rgb(255, 0, 0);">:</span><span style="color: rgb(255, 0, 0);">/etc/selinux/config </span><span style="color: rgb(255, 0, 0);">/etc/selinux/config</span></div><div><span style="color: rgb(255, 0, 0);">                </span><span style="color: rgb(255, 0, 0);">scp -r</span> <span style="color: rgb(166, 0, 196);">192.168.123.101</span><span style="color: rgb(255, 0, 0);">:</span><span style="color: rgb(255, 0, 0);">/etc/sudoers </span><span style="color: rgb(255, 0, 0);">/etc/sudoers</span></div><div><span style="color: rgb(255, 0, 0);">                </span><span style="color: rgb(255, 0, 0);">scp -r</span> <span style="color: rgb(166, 0, 196);">192.168.123.101</span><span style="color: rgb(255, 0, 0);">:/etc/</span><span style="color: rgb(255, 0, 0);">inittab</span> <span style="color: rgb(255, 0, 0);">/etc/</span><span style="color: rgb(255, 0, 0);">inittab</span></div><div><span style="color: rgb(168, 168, 168);">        #以下几步是给所有主机安装jdk</span></div><div><span style="color: rgb(255, 0, 0);">                </span><span style="color: rgb(255, 0, 0);">scp -r</span> <span style="color: rgb(166, 0, 196);">192.168.123.101</span><span style="color: rgb(255, 0, 0);">:/usr/local/java/ /usr/local/java/        </span></div><div><span style="color: rgb(255, 0, 0);">                </span><span style="color: rgb(255, 0, 0);">scp -r</span> <span style="color: rgb(166, 0, 196);">192.168.123.101</span><span style="color: rgb(255, 0, 0);">:/etc/profile /</span><span style="color: rgb(255, 0, 0);">etc/profile</span></div><div><span style="color: rgb(255, 0, 0);">                source /etc/profile</span></div><div><span style="color: rgb(255, 0, 0);">                java -version</span></div><div><br/></div><div><br/></div><div><br/></div><div><span style="color: rgb(255, 0, 0);">        14、全部节点单独安装一下MySQL          </span><span style="color: rgb(168, 168, 168);">##绿色字体视文件或文件夹名称而变；蓝色字体表示输入窗口本就存在的内                                                         ##容，不需输入，只是提醒一下此处输入时前缀有这些字符</span></div><div><span style="color: rgb(255, 0, 0);">            采用rpm方式安装</span></div><div><span style="color: rgb(255, 0, 0);">          （1）</span><span style="color: rgb(255, 0, 0);">、 检查以前是否装过MySQL</span><span style="color: rgb(255, 0, 0);">           </span><span style="color: rgb(255, 0, 0);">rpm -qa|grep -i mysql</span></div><div><span style="color: rgb(255, 0, 0);">          </span><span style="color: rgb(255, 0, 0);">（2）、 发现有的话就都卸载                   </span><span style="color: rgb(255, 0, 0);">rpm -e --nodeps</span> <span style="color: rgb(77, 206, 29);">mysql-libs-5.1.73-5.el6_6.x86_64</span></div><div><span style="color: rgb(77, 206, 29);"><img src="day7-集群环境搭建（1）_files/Image [10].png" type="image/png" data-filename="Image.png"/></span></div><div>          <span style="color: rgb(255, 0, 0);">（3）</span><span style="color: rgb(255, 0, 0);">、 删除老版本 mysql 的开发头文件和库</span></div><div><span style="color: rgb(255, 0, 0);">                                    rm -rf /usr/lib/mysql</span></div><div><span style="color: rgb(255, 0, 0);">                                    rm -rf /usr/include/mysql</span></div><div><span style="color: rgb(255, 0, 0);">                                    rm -rf /etc/my.cnf</span></div><div><span style="color: rgb(255, 0, 0);">                                    rm -rf /var/lib/mysql</span></div><div><span style="color: rgb(255, 0, 0);">         </span> <span style="color: rgb(255, 0, 0);">（4）</span><span style="color: rgb(255, 0, 0);">在SecureCRT按 alt+p 键进入SFTP文件传输界面</span></div><div><span style="color: rgb(255, 0, 0);">                </span><span style="color: rgb(26, 173, 224);">sftp&gt;</span> <span style="color: rgb(255, 0, 0);">put</span> <span style="color: rgb(77, 206, 29);">d:/暑假Hadoop/软件/MySQL-5.6.45-1.el6.x86_64.rpm-bundle.tar</span></div><div><span style="color: rgb(168, 168, 168);">             ##jdk的安装需要给它建立安装目录存放安装的配置文件，mysql则不用</span></div><div><span style="color: rgb(255, 0, 0);">         </span> <span style="color: rgb(255, 0, 0);">（5）</span><span style="color: rgb(255, 0, 0);">解压：        </span><span style="color: rgb(255, 0, 0);">tar -xvf</span> <span style="color: rgb(77, 206, 29);">MySQL-5.6.45-1.el6.x86_64.rpm-bundle.tar</span></div><div><span style="color: rgb(255, 0, 0);">                </span>解压后只需安装server和client即可，解压后如图</div><div><span style="color: rgb(255, 0, 0);"><img src="day7-集群环境搭建（1）_files/Image [11].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="color: rgb(255, 0, 0);">         </span> <span style="color: rgb(255, 0, 0);">（6）</span><span style="color: rgb(255, 0, 0);">安装server（也就是服务器）         </span><span style="color: rgb(255, 0, 0);">rpm -ivh</span> <span style="color: rgb(77, 206, 29);">MySQL-server-5.6.45-1.el6.x86_64.rpm</span></div><div><span style="color: rgb(255, 0, 0);">        </span>安装成功时会提示系统随机生成的密码放在哪里，在安装完成时的最后一页会有提示，如图：</div><div><span style="color: rgb(255, 0, 0);"><img src="day7-集群环境搭建（1）_files/Image [12].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="color: rgb(255, 0, 0);">         </span> <span style="color: rgb(255, 0, 0);">（7）</span><span style="color: rgb(255, 0, 0);">安装client（也就是客户端）          </span><span style="color: rgb(255, 0, 0);">rpm -ivh</span> <span style="color: rgb(77, 206, 29);">MySQL-client-5.6.45-1.el6.x86_64.rpm</span></div><div><span style="color: rgb(255, 0, 0);">         </span> <span style="color: rgb(255, 0, 0);">（8）</span><span style="color: rgb(255, 0, 0);">启动mysql服务                             </span><span style="color: rgb(255, 0, 0);">service mysql start</span></div><div><span style="color: rgb(255, 0, 0);">         </span> <span style="color: rgb(255, 0, 0);">（9）</span><span style="color: rgb(255, 0, 0);">修改root用户的登录密码                </span></div><div><span style="color: rgb(255, 0, 0);">                  a、首先要找到安装时系统随机生成的密码：    </span><span style="color: rgb(255, 0, 0);">cat /root/.mysql_secret</span></div><div><span style="color: rgb(255, 0, 0);"><img src="day7-集群环境搭建（1）_files/Image [13].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="color: rgb(255, 0, 0);">                  b、复制该密码，并使用该随机密码登录            </span></div><div><span style="color: rgb(255, 0, 0);">                        mysql -u root -p</span><span style="color: rgb(77, 206, 29);">zOMdjv4V4a__fDQB   </span><span style="color: rgb(168, 168, 168);">#注意:-p和密码之间不能有空格,-u和用户名之间可有可无</span></div><div><span style="color: rgb(168, 168, 168);"><img src="day7-集群环境搭建（1）_files/Image [14].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="color: rgb(168, 168, 168);">    </span><span style="color: rgb(168, 168, 168);">    </span><span style="color: rgb(168, 168, 168);">    </span><span style="color: rgb(168, 168, 168);">    </span><span style="color: rgb(168, 168, 168);"> </span> <span style="color: rgb(255, 0, 0);">c、登录后，在登录状态下用mysql语句修改密码并退出</span></div><div><span style="color: rgb(255, 0, 0);">                                  </span><span style="color: rgb(26, 173, 224);">mysql&gt;</span> <span style="color: rgb(255, 0, 0);">set PASSWORD=</span><span style="color: rgb(255, 0, 0);">PASSWORD</span><span style="color: rgb(255, 0, 0);">(&quot;root&quot;);</span></div><div><span style="color: rgb(255, 0, 0);">                                  </span><span style="color: rgb(26, 173, 224);">mysql&gt;</span> <span style="color: rgb(255, 0, 0);">exit；</span><span style="color: rgb(255, 0, 0);"> </span></div><div><span style="color: rgb(255, 0, 0);">        （10）用新密码登录，验证密码</span><span style="color: rgb(255, 0, 0);">是否改密码成功，登录后赋予root用户在其他主机上的</span><span style="color: rgb(255, 0, 0);">远程登陆权限，并刷新</span></div><div><span style="color: rgb(255, 0, 0);">                          </span> <span style="color: rgb(255, 0, 0);">mysql -u root -proot</span></div><div><span style="color: rgb(255, 0, 0);">             </span><span style="color: rgb(26, 173, 224);">mysql&gt;</span> <span style="color: rgb(255, 0, 0);">GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'root' WITH GRANT OPTION;</span></div><div><span style="color: rgb(255, 0, 0);">             </span><span style="color: rgb(26, 173, 224);">mysql&gt;</span> <span style="color: rgb(255, 0, 0);">FLUSH PRIVILEGES;          </span><span style="color: rgb(168, 168, 168);">#这一行意思是刷新，刷新后，赋予的权限才会生效</span></div><div><span style="color: rgb(168, 168, 168);"><img src="day7-集群环境搭建（1）_files/Image [15].png" type="image/png" data-filename="Image.png"/></span></div></span>
</div></body></html> 