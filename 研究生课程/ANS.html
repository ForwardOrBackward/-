<html>
<head>
  <title>ANS</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/603932 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 12pt;
    }
  </style>
</head>
<body>
<a name="9320"/>
<h1>ANS</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2022/2/27 17:40</i></td></tr>
<tr><td><b>更新时间：</b></td><td><i>2022/3/4 11:04</i></td></tr>
</table>
</div>
<br/>

<div>
<span><div><br/></div><div style="min-height: 2237px; font-size: 16px; display: table-row; min-width: 100%; position: relative;"><div><br/></div><table><colgroup><col style="width: 130px;"></col></colgroup><tbody><tr><td><h2><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">非对称数字系统</span></font></h2><hr/><div><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit; font-style: italic;">带有演示的源代码可用：     </span></font> <a href="http://www.ezcodesample.com/abs/ANSCoder.txt" style="font-size: 16px; vertical-align: inherit;"></a><a href="http://www.ezcodesample.com/abs/ANSCoder.txt" style="font-size: 16px; font-style: italic; vertical-align: inherit;">ANSCoder</a></div><hr/><div><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">Jarek Duda 出于几个不同的目的引入了不对称数字系统。</span><span style="font-size: 16px; vertical-align: inherit;">我们这里只考虑数据压缩方面。</span><span style="font-size: 16px; vertical-align: inherit;">想要了解更多信息的人可以尝试阅读最新的</span></font><a href="http://arxiv.org/abs/0902.0271" style="font-size: 16px; vertical-align: inherit;"></a><a href="http://arxiv.org/abs/0902.0271" style="font-size: 16px; vertical-align: inherit;">Jareks 文章</a> <font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">ANS 编码器的第一个演示由作者于 2008 年 3 月在</span></font> <a href="http://demonstrations.wolfram.com/DataCompressionUsingAsymmetricNumeralSystems/" style="font-size: 16px; vertical-align: inherit;"><font style="vertical-align:inherit;">Wolfram</font></a><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">上发表，这意味着这种方法不太可能获得专利，因为申请专利的时间已经不多了，作者多次确认他无意为这种方法申请专利。</span></font></div><div><br/></div><div><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">根据</span></font><a href="https://news.ycombinator.com/item?id=12399804" style="font-size: 16px; vertical-align: inherit;"></a><a href="https://news.ycombinator.com/item?id=12399804" style="font-size: 16px; vertical-align: inherit;">在线新闻</a><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">，这种编码方法用于 Facebook 的 ZSTANDARD 压缩器。</span></font></div><table cellspacing="8"><colgroup><col style="width: 130px;"></col></colgroup><tbody><tr><td><div><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit; font-weight: bold;">编码/解码表</span></font></div><table border="1" cellpadding="3"><colgroup><col style="width: 130px;"></col><col style="width: 130px;"></col><col style="width: 130px;"></col><col style="width: 130px;"></col></colgroup><tbody><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">state  </span></font></td><td><div><span style="font-size: 16px;"> A        </span></div></td><td><div><span style="font-size: 16px;">B                      </span></div></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">C     </span></font></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit; color: red;">1</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">2</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit; color: red;">3</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">5</span></font></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">2</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">4</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">6</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">10</span></font></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit; color: red;">3</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit; color: red;">7</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">8</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">15</span></font></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">4</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">9</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">11</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">20</span></font></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">5</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">12</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">14</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">25</span></font></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">6   </span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">13</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">17</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">30</span></font></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit; color: red;">7</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit; color: red;">16</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">21</span></font></td><td><span style="font-size: 16px;"> </span></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">8</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">18</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">22</span></font></td><td><span style="font-size: 16px;"> </span></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">9</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">19</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">26</span></font></td><td><span style="font-size: 16px;"> </span></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">10</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">23 </span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">28 </span></font></td><td><span style="font-size: 16px;"> </span></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">11</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">24</span></font></td><td><span style="font-size: 16px;"> </span></td><td><span style="font-size: 16px;"> </span></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">12</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">27</span></font></td><td><span style="font-size: 16px;"> </span></td><td><span style="font-size: 16px;"> </span></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">13</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">29</span></font></td><td><span style="font-size: 16px;"> </span></td><td><span style="font-size: 16px;"> </span></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">14</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">31</span></font></td><td><span style="font-size: 16px;"> </span></td><td><span style="font-size: 16px;"> </span></td></tr></tbody></table><div><br/></div><div><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">根据方法，我们需要创建单个查找表，如上所示。</span><span style="font-size: 16px; vertical-align: inherit;">编码可以从任何行和字母表的任何符号（A、B、C）开始。</span><span style="font-size: 16px; vertical-align: inherit;">如果消息中的第一个符号是 B 并且第一行是 1，我们从第 1 行和 B 列的交叉处获取新的行号，即 3 并移动到下一行。</span><span style="font-size: 16px; vertical-align: inherit;">如果下一个符号是 A，我们从 A 列和第 3 行的交叉处读取下一个行号。这个数字是 7，我们可以继续直到我们的表的最终扩展。</span></font></div><div><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">解码与编码一样基本。</span><span style="font-size: 16px; vertical-align: inherit;">有任何数字，比如说 16，我们可以提取符号 A 和前第 7 行。回到表中的第 7 个元素，我们可以提取另一个符号 A 和另一个新的第 3 行。最后从元素 3 我们提取 B 和第 1 行，这是表上的最高点和消息的结尾。</span><span style="font-size: 16px; vertical-align: inherit;">成功的编码和解码是可能的，如果</span></font></div><ul><li><div><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">表中的左列包含所有序号。</span></font></div></li><li><div><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">A、B、C 列中的包含的所有数字</span></font><span style="font-size: 16px;">在这三列中</span><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">都是唯一的（不重复）。</span></font></div></li><li><div><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">每行中的数字都大于该行的行号。</span></font></div></li><li><div><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">所有列中的数字均已排序。</span></font></div></li></ul><div><span style="font-size: 16px; vertical-align: inherit;">每一步之后获得的行数称为state。</span><span style="font-size: 16px; vertical-align: inherit;">有了state，我们可以恢复消息。</span><span style="font-size: 16px; vertical-align: inherit;">This encoder becomes entropy encoder when numbers in columns are selected to match probability of occurrence of correspondent symbol if we divide row number by the value in the column.</span> <span style="font-size: 16px; vertical-align: inherit;">在这个表中，如果我们将行号除以 A 列中的该行对应的任何一个值，都大约是 0.45。</span><span style="font-size: 16px; vertical-align: inherit;">B 的比率为 0.35，C 的比率为 0.2。</span><span style="font-size: 16px; vertical-align: inherit;">根据公式</span> <font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit; font-weight: bold;">state</span></font> <span style="font-size: 16px;"><span style="font-size: 16px; font-weight: bold; vertical-align: sub;">i</span></span> <font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit; font-weight: bold;">= state</span></font> <span style="font-size: 16px;"><span style="font-size: 16px; font-weight: bold; vertical-align: sub;">i-1</span></span> <font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit; font-weight: bold;"> / P{symbol}</span></font> <font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">，state在每一步都在增长， 这意味着在编码结束时，我们将得到长度等于</span></font> <span style="font-size: 16px; vertical-align: inherit; font-weight: bold;">1 / [P{B} * P{A}</span> <span style="font-size: 16px; vertical-align: inherit; font-weight: bold;">* P{A} ...]</span> <font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">这显然与熵一致。</span></font></div><div><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">这个简短的介绍中唯一遗漏的部分是当我们到达表格底部时如何管理state。</span><span style="font-size: 16px; vertical-align: inherit;">这可以在有 ANSCoder 示例的文章中阅读。</span><span style="font-size: 16px; vertical-align: inherit;">除了已经解释的内容之外，我们还需要以与解码同步的方式添加对编码中的比特输出的管理。</span><span style="font-size: 16px; vertical-align: inherit;">让我们回到我们的例子。</span><span style="font-size: 16px; vertical-align: inherit;">这个概念与 Jarek Duda 编写的 ANSCoder 原始示例中使用的概念接近或相似。</span><span style="font-size: 16px; vertical-align: inherit;">根据概念，解码器在执行每一步之前读取一定数量的bit以使state缓冲区大小相同。</span><span style="font-size: 16px; vertical-align: inherit;">从表中可以看出，在解码过程中，每一步的state都会变小，所以如果解码器总是读取任意数量的bit以使其具有相同的大小，我们永远不会做出错误的选择，并且解码变得非常简单：</span><span style="font-size: 16px; vertical-align: inherit;">读取bit，处理符号；再读取比特，再处理符号...</span></font></div><div><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">在解释编码之前，让我们先展示一下解码过程。</span><span style="font-size: 16px; vertical-align: inherit;">假设我们有以下二进制表达式要解码：</span></font> <font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit; font-weight: bold;">11000011110</span></font> <font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">。</span><span style="font-size: 16px; vertical-align: inherit;">根据 ANS 编码器的主要属性，我们逆向解码。</span><span style="font-size: 16px; vertical-align: inherit;">根据我们表的大小，我们指定state缓冲区的大小为 5 bit。</span><span style="font-size: 16px; vertical-align: inherit;">在第一步中，我们读取上面显示的编码表达式的最后 5 bit，即</span></font> <font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit; font-weight: bold;">11110</span></font><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">(表达式变为</span></font><span style="font-size: 16px; font-weight: bold;">110000</span><span style="vertical-align: inherit; font-size: 16px;">)，并使用该数字（即 30，也就是state</span><span style="font-size: 16px;"><span style="font-size: 16px; vertical-align: sub;">i</span></span><span style="vertical-align: inherit; font-size: 16px;">）对表进行寻址。我们提取符号 C 并创建新的state </span><span style="font-size: 16px;">6 </span><span style="vertical-align: inherit; font-size: 16px;">(也就是</span><span style="font-size: 16px; color: unset; font-family: unset;">state</span><span style="vertical-align: sub; font-size: smaller; color: unset; font-family: unset;">i-1</span><span style="vertical-align: inherit; font-size: 16px;">)(二进制格式</span><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit; font-weight: bold;">110</span></font><span style="font-size: 16px; color: unset; font-family: unset;">)，<span style="font-size: 16px; color: unset; font-family: unset; font-weight: bold;">state</span><span style="font-size: 16px; color: unset; font-family: unset; font-weight: bold; vertical-align: sub;">i-1</span><span style="font-size: 16px; color: unset; font-family: unset; font-weight: bold;">由</span></span><span style="font-size: 16px; font-weight: bold;">state</span><span style="vertical-align: sub; font-size: smaller; font-weight: bold;">i</span><span style="font-size: 16px; font-weight: bold; color: unset; font-family: unset;">对应所在的行号获得</span><font style="vertical-align: inherit;"><span style="vertical-align: inherit; font-size: 16px; color: unset; font-family: unset;">。</span><span style="vertical-align: inherit; font-size: 16px; color: unset; font-family: unset;">为了使我们的新state缓冲区匹配大小 5，我们从表达式</span></font><span style="font-size: 16px; font-weight: bold;">110000</span><font style="vertical-align: inherit;"><span style="vertical-align: inherit; font-size: 16px; color: unset; font-family: unset;">中</span></font><span style="font-size: 16px; color: unset; font-family: unset;">再</span><font style="vertical-align: inherit;"><span style="vertical-align: inherit; font-size: 16px; color: unset; font-family: unset;">读取末尾 2 bit放到state的末尾，和</span></font><span style="font-size: 16px;">6拼接起来</span><font style="vertical-align: inherit;"><span style="vertical-align: inherit; font-size: 16px; color: unset; font-family: unset;">，得到</span></font> <font style="vertical-align: inherit;"><span style="vertical-align: inherit; font-size: 16px; color: unset; font-family: unset; font-weight: bold;">11000</span></font><span style="font-size: 16px;">(表达式变为</span><span style="font-size: 16px; font-weight: bold;">1100</span><span style="font-size: 16px;">)</span><font style="vertical-align: inherit;"><span style="vertical-align: inherit; font-size: 16px; color: unset; font-family: unset;">，</span><span style="vertical-align: inherit; font-size: 16px; color: unset; font-family: unset;">即24。对于 state=24，再去查表，从表中提取到符号 A 并创建新的state 11，即二进制格式</span></font><font style="vertical-align: inherit;"><span style="vertical-align: inherit; font-size: 16px; color: unset; font-family: unset; font-weight: bold;">1011</span></font><span style="vertical-align: inherit; font-size: 16px; color: unset; font-family: unset;">.</span> <span style="vertical-align: inherit; font-size: 16px; color: unset; font-family: unset;">我们再从表达式读1 bit(</span><span style="font-size: 16px;">表达式变为</span><span style="font-size: 16px; font-weight: bold;">110</span><span style="font-size: 16px;">)</span><font style="vertical-align: inherit;"><span style="vertical-align: inherit; font-size: 16px; color: unset; font-family: unset;">，得到 (</span></font> <font style="vertical-align: inherit;"><span style="vertical-align: inherit; font-size: 16px; color: unset; font-family: unset; font-weight: bold;">10110</span></font> <font style="vertical-align: inherit;"><span style="vertical-align: inherit; font-size: 16px; color: unset; font-family: unset;">) ，即22。接下来重复以上过程：用22查表查表提取 B，创建新的 state=8，再从表达式读一bit</span></font><span style="font-size: 16px; color: unset; font-family: unset;">(</span><span style="font-size: 16px;">表达式变为</span><span style="font-size: 16px; font-weight: bold;">11</span><span style="font-size: 16px;">)</span><font style="vertical-align: inherit;"><span style="vertical-align: inherit; font-size: 16px; color: unset; font-family: unset;">，得到 16；用16查表提取出 A，得到 7，读表达式的最后两bit，得到 end-消息标记</span></font><font style="vertical-align: inherit;"><span style="vertical-align: inherit; font-size: 16px; color: unset; font-family: unset; font-weight: bold;">11111</span></font><font style="vertical-align: inherit;"><span style="vertical-align: inherit; font-size: 16px; color: unset; font-family: unset;">。</span><span style="vertical-align: inherit; font-size: 16px; color: unset; font-family: unset;">我们知道这是消息的结尾，因为没有更多要读取的和state与默认标记匹配。</span></font></div><div><span style="font-size: 16px;">编码过程要复杂一些。</span><span style="font-size: 16px;">在编码中，我们需要输出比特来搭建我们在解码中使用的简单易实现的解码方法。</span><span style="font-size: 16px;">编码过程如下表所示。</span><span style="font-size: 16px;">我们可以从任何 5 bit的数字开始编码，但我们更喜欢使用结束/开始标记 31 (</span> <span style="font-size: 16px; font-weight: bold;">11111</span> <span style="font-size: 16px;">)作为起始的编码标记。</span><span style="font-size: 16px;">编码的概念有点复杂。</span><span style="font-size: 16px;">我们在处理符号之前要先输出bit(要输出bit的情况都是因为当前状态过大了，要先输出一部门。输出的bit放在比特流里，比特流就是最终得到的状态码，也就是序列压缩后的样子)。</span><span style="font-size: 16px;">如你所见，我们无法处理 31，编码/解码表里不会有行号 31(</span><span style="font-size: 16px; color: rgb(166, 0, 196);">编码表本就是在编码时创建的吗?不然是何时创建的?如何得到的?</span><span style="font-size: 16px;">)，因此我们需要先输出尽可能多的bit，让剩余的bit</span><span style="font-size: 16px;">(即state</span><span style="font-size: smaller; vertical-align: sub; font-size: smaller;">i-1</span><span style="font-size: 16px;">)</span><span style="font-size: 16px;">尽可能小</span><span style="font-size: 16px;">，方便让行号或状态缓慢递增，以满足上面提到的成功的编/解码的4条规则了。输出完bit之后再处理符号。</span><span style="font-size: 16px;">因为我们知道我们正在处理什么符号，是A</span><span style="font-size: 16px;">，我们需要输出两个最低位bit，即</span> <span style="font-size: 16px; font-weight: bold;">11</span><span style="font-size: 16px;">. (第一次编码输出的bit要作为行号，所以要考虑好行号(</span><span style="font-size: 16px; color: unset; font-family: unset;">state</span><span style="vertical-align: sub; font-size: smaller; color: unset; font-family: unset;">i-1</span><span style="font-size: 16px;">)和剩余的state(</span><span style="font-size: 16px; color: unset; font-family: unset;">state</span><span style="vertical-align: sub; font-size: smaller; color: unset; font-family: unset;">i</span><span style="font-size: 16px;">)的值，因为输出一个最低为bit的话，输出的bit的剩余的bit相差太大，达不到&quot;行号/A列的值≈p(A)&quot;的要求)。</span><span style="font-size: 16px;">我们在表格中展示了整个过程。</span><span style="font-size: 16px;">我们输出bit之前的数字是 31。在这个数字下面那一行是我们输出到流中的两个bit。在输出掉两个bit后剩余状态是</span><span style="font-size: 16px;">state=7 (111)。</span><span style="font-size: 16px;">我们用符号 A 处理 7 (处理的方法是</span><span style="font-size: 16px; font-weight: bold;">state</span> <span style="vertical-align: sub; font-size: smaller; font-weight: bold;">i</span> <span style="font-size: 16px; font-weight: bold;">= state</span> <span style="vertical-align: sub; font-size: smaller; font-weight: bold;">i-1</span> <span style="font-size: 16px; font-weight: bold;"> / P{symbol}</span><span style="font-size: 16px;">，也就是说下一个状态 = 上一个状态7 / A出现的概率0.45</span><span style="font-size: 16px;">)，,</span><span style="font-size: 16px;">得到新的 state=16。</span><span style="font-size: 16px;">下一个符号是B。根据表格我们知道，我们不能处理state=16的B(因为B没有第16行)，所以我们需要输出</span><span style="font-size: 16px; color: unset; font-family: unset;">一个最低位的bit </span><span style="font-size: 16px; color: unset; font-family: unset; font-weight: bold;">0</span><span style="font-size: 16px; color: unset; font-family: unset;">，并使新state=8</span> <span style="font-size: 16px; color: unset; font-family: unset;">。</span><span style="font-size: 16px; color: unset; font-family: unset;">在为 state=8 处理 B</span><span style="font-size: 16px; color: unset; font-family: unset;">(</span><span style="font-size: 16px; color: unset; font-family: unset;">处理的方法依然是</span><span style="font-size: 16px; color: unset; font-family: unset; font-weight: bold;">state</span> <span style="vertical-align: sub; font-size: smaller; color: unset; font-family: unset; font-weight: bold;">i</span> <span style="font-size: 16px; color: unset; font-family: unset; font-weight: bold;">= state</span> <span style="vertical-align: sub; font-size: smaller; color: unset; font-family: unset; font-weight: bold;">i-1</span> <span style="font-size: 16px; color: unset; font-family: unset; font-weight: bold;"> / P{symbol}</span><span style="font-size: 16px; color: unset; font-family: unset;">)</span> <span style="font-size: 16px; color: unset; font-family: unset;">之后，我们得到 22</span><span style="font-size: 16px; color: unset; font-family: unset;">，依此类推。</span><span style="font-size: 16px; color: unset; font-family: unset;">我们必须输出最低位bit，因为我们需要减少数量。</span><span style="font-size: 16px; color: unset; font-family: unset;">在我们处理完最后一个符号 C 之后，我们有 state=30 并且我们完全输出它，所以我们的输出缓冲区看起来像上面所示。</span></div><div><span style="font-size: 16px;">关于编码时某个符号的state过大，不能处理，需要从最低位输出bit时，到底输出多少个bit，大概是这样的规则：</span></div><div><span style="font-size: 16px;">    (1)输出的bit要尽可能多，但bit输出后的剩余state不能比上一个相同字符的行号小。</span></div><div><span style="font-size: 16px;">    (2)起始编码标记编码时要考虑到行号多大，要满足&quot;</span><span style="font-size: 16px;">行号/剩余state≈p(A)&quot;</span></div><table><colgroup><col style="width: 130px;"></col></colgroup><tbody><tr><td><div><br/></div><table cellpadding="20"><colgroup><col style="width: 130px;"></col><col style="width: 130px;"></col></colgroup><tbody><tr><td><div><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">编码/解码</span></font></div><table border="1" cellpadding="3"><colgroup><col style="width: 130px;"></col><col style="width: 130px;"></col><col style="width: 130px;"></col><col style="width: 130px;"></col></colgroup><tbody><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">state </span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">A</span></font></td><td><div><span style="font-size: 16px;">B</span></div></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">C </span></font></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">1</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">2</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">3</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">5</span></font></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">2</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">4</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">6</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">10</span></font></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">3</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">7</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">8</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">15</span></font></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">4</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">9</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">11</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">20</span></font></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">5</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">12</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">14</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">25</span></font></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">6</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">13</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">17</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">30 </span></font></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">7</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">16 </span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">21 </span></font></td><td><span style="font-size: 16px;"> </span></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">8</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">18</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">22</span></font></td><td><span style="font-size: 16px;"> </span></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">9</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">19</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">26</span></font></td><td><span style="font-size: 16px;"> </span></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">10</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">23</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">28</span></font></td><td><span style="font-size: 16px;"> </span></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">11</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">24</span></font></td><td><span style="font-size: 16px;"> </span></td><td><span style="font-size: 16px;"> </span></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">12</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">27</span></font></td><td><span style="font-size: 16px;"> </span></td><td><span style="font-size: 16px;"> </span></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">13</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">29</span></font></td><td><span style="font-size: 16px;"> </span></td><td><span style="font-size: 16px;"> </span></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">14</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">31</span></font></td><td><span style="font-size: 16px;"> </span></td><td><span style="font-size: 16px;"> </span></td></tr></tbody></table><div><br/></div></td><td><div><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">编码过程</span></font></div><table border="1" cellpadding="3"><colgroup><col style="width: 130px;"></col><col style="width: 130px;"></col><col style="width: 130px;"></col><col style="width: 130px;"></col><col style="width: 130px;"></col></colgroup><tbody><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">bit输出前的state</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">31 </span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">16 </span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">22 </span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">24 </span></font></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">输出bit </span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">11</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">0</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">0</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">00</span></font></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">bit输出后的state</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">7</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">8</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">11</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">6</span></font></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">处理符号</span></font></td><td><span style="font-size: 16px;">A</span></td><td><div><span style="font-size: 16px;">B</span></div></td><td><div><span style="font-size: 16px;">A</span></div></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">C</span></font></td></tr><tr><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">处理后的state</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">16</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">22</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">24</span></font></td><td><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;">30</span></font></td></tr></tbody></table><div><br/></div></td></tr></tbody></table><div><font style="vertical-align:inherit;"><span style="font-size: 16px; vertical-align: inherit;"> </span></font></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></td></tr></tbody></table><div><br/></div></td></tr></tbody></table><div><br/></div></td></tr></tbody></table><div><br/></div></div><div><br/></div></span>
</div></body></html> 